\documentclass[11pt]{article}
% 中文 \documentclass[UTF8]{ctexart}
% 编译快捷键：Command+Option+B

% 显示快捷键：Command+Option+V

% 正向搜索：选中代码Command+Option+J

% 反向搜索：shift+command点击预览PDF


\usepackage[utf8]{inputenc}


\usepackage{graphicx}


\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{mathrsfs}
\usepackage{bm}

\usepackage{nicematrix}
\usepackage{tikz}
\usepackage{physics}


\usepackage{enumerate}
\usepackage{hyperref}

\usepackage{verbatim}
\usepackage{url}
\usepackage{listings}
\usepackage{color} %red, green, blue, yellow, cyan, magenta, black, white


\usepackage{rotating}


\usepackage[english]{babel}



\usepackage{mathtools}


\usepackage{geometry}

% \geometry{a4paper,scale=0.8}

\geometry{a4paper,left=2cm,right=2cm,top=2cm,bottom=3cm}

\usepackage{graphicx}
\usepackage{float}

\newcommand{\diag}{\mathop{\mathrm{diag}}}

\newcommand{\triu}{\mathop{\mathrm{triu}}}
\newcommand{\tril}{\mathop{\mathrm{tril}}}
\newcommand{\T}{\mathrm{T}}

\newcommand{\redtext}[1]{\textcolor{red}{#1}}

\newcommand{\bigzero}{\mbox{\normalfont\Large\bfseries 0}}
\newcommand{\rvline}{\hspace*{-\arraycolsep}\vline\hspace*{-\arraycolsep}}


\title{\textbf{Meeting Notes}}
\author{\textit{Zhiwei Zhou}}
% \date{April 2022}

\begin{document}

\maketitle

\section{28.06.2022 Meeting draft}


\subsection{Tridiagonal matrix (Upper)}




% \noindent Let $U \in \mathbb{R}^{n \times n}$ be a bidiagonal matrix with non-zero diagonal, 
% $i.e. \ u_{ii} \neq 0 \ \text{for} \ i = 1, 2, \ldots , n$,


$n = 2k$

\begin{align*}
    U &= \mqty[
        d_{1} & b^{1}_{1} & b^{2}_{1} &   &   &   &   &   &  \\
          & d_{2} & b^{1}_{2} & b^{2}_{2} &   &   &   &   &  \\
          &   & d_{3} & b^{1}_{3} & b^{2}_{3} &   &   &   &  \\
          &   &   & d_{4} & b^{1}_{4} & b^{2}_{4} &   &   &  \\
          &   &   &   & \ddots & \ddots & \ddots &   &  \\
          &   &   &   && \ddots & \ddots & \ddots &  \\
          &   &   &   &&   & d_{n-3} & b^{1}_{n-3} & b^{2}_{n-3} &  \\
          &   &   &   &&   &   & d_{n-2} & b^{1}_{n-2} & b^{2}_{n-2}\\
          &   &   &   &&   &   &   & d_{n-1} & b^{1}_{n-1}\\
          &   &   &   &&  &   &   &   & d_{n}
    ]\\
    &= \mqty[
        \mqty[d_{1} & b^{1}_{1} \\ & d_{2}] & \mqty[b^{2}_{1} &  \\ b^{1}_{2} & b^{2}_{2}] &   &   &  \\
          & \mqty[d_{3} & b^{1}_{3} \\ & d_{4}] & \mqty[b^{2}_{3} & \\ b^{1}_{4} & b^{2}_{4}] &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & \mqty[d_{2k-3} & b^{1}_{2k-3} \\ & d_{2k-2}] & \mqty[b^{2}_{2k-3} & \\ b^{1}_{2k-2} & b^{2}_{2k-2}] \\
          &   &   &   & \mqty[d_{2k-1} & b^{1}_{2k-1}\\ & d_{2k}]
    ]\\
    &= \mqty[
        D_{1} & B_{1} &   &   &  \\
          & D_{2} & B_{2} &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & D_{k-1} & B_{k-1}\\
          &   &   &   & D_{k}
    ] \in \mathbb{R}^{2k \times 2k}
\end{align*}

\begin{align*}
    X &= \mqty[
        X_{1} \\
        X_{2} \\
        \vdots \\
        X_{k-1} \\
        X_{k}
        ]
    \in \mathbb{R}^{2k \times 2}
    &
    Y &= \mqty[
        Y_{1} \\
        Y_{2} \\
        \vdots \\
        Y_{k-1} \\
        Y_{k}
        ]
    \in \mathbb{R}^{2k \times 2}
    &
    Y^{\T} &= \mqty[
        Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
        ] \in \mathbb{R}^{2 \times 2k}
\end{align*}



\begin{align*}
    XY^{\T} &= \mqty[
        X_{1} \\
        X_{2} \\
        \vdots \\
        X_{k-1} \\
        X_{k}
        ]
        \mqty[
        Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
        ]\\
    &= \mqty[
        X_{1} Y_{1}^{\T} & X_{1} Y_{2}^{\T} & \cdots & X_{1} Y_{k-1}^{\T} & x_{1} Y_{k}^{\T}\\
        X_{2} Y_{1}^{\T} & X_{2} Y_{2}^{\T} & \cdots & X_{2} Y_{k-1}^{\T} & x_{2} Y_{k}^{\T}\\
        \vdots & \vdots & \ddots & \vdots & \vdots\\
        X_{k-1} Y_{1}^{\T} & X_{k-1} Y_{2}^{\T} & \cdots & X_{k-1} Y_{k-1}^{\T} & X_{k-1} Y_{k}^{\T}\\
        X_{k} Y_{1}^{\T} & X_{k} Y_{2}^{\T} & \cdots & X_{k} Y_{k-1}^{\T} & X_{k} Y_{k}^{\T}
        ]\\
    &= X\mqty[
        Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
            ]\\
    &= \mqty[
        XY_{1}^{\T} & XY_{2}^{\T} & \cdots & XY_{k-1}^{\T} & XY_{k}^{\T}
        ]
\end{align*}

\begin{align*}
    \triu(X_{k}) &\coloneqq X_{k} \\
    \triu(Y_{k}^{\T}) &\coloneqq Y_{k}^{\T} \\
    \triu(X_{k} Y_{k}^{\T}) &= X_{k} Y_{k}^{\T}
\end{align*}

\begin{align*}
    \triu(XY^{\T}) &= \mqty[
        \triu(X_{1} Y_{1}^{\T}) & X_{1} Y_{2}^{\T} & \cdots & X_{1} Y_{k-1}^{\T} & X_{1} Y_{k}^{\T}\\
        0_{2 \times 2} & \triu(X_{2} Y_{2}^{\T}) & \cdots & X_{2} Y_{k-1}^{\T} & X_{2} Y_{k}^{\T}\\
        \vdots & \vdots & \ddots & \vdots & \vdots\\
        0_{2 \times 2} & 0_{2 \times 2} & \cdots & \triu(X_{k-1} Y_{k-1}^{\T}) & X_{k-1} Y_{k}^{\T}\\
        0_{2 \times 2} & 0_{2 \times 2} & \cdots & 0_{2 \times 2} & X_{k} Y_{k}^{\T}
        ]\\
    &= \mqty[
        \mqty[
            \triu(X_{1} Y_{1}^{\T}) \\
            0_{2(k-1) \times 2}
            ] &
        \mqty[
            X_{1} Y_{2}^{\T} \\
            \triu(X_{2} Y_{2}^{\T}) \\
            0_{2(k-2) \times 2}
            ] &
        \cdots &
        \mqty[
            X_{1:k-2}Y_{k-1}^{\T} \\
            \triu(X_{k-1}Y_{k-1}^{\T}) \\
            0_{2 \times 2}
            ] &
        X Y_{k}^{\T}
        ]
\end{align*}


\begin{align*}
    U^{-1} &= \triu(XY^{\T}) \\
    I &= U \triu(XY^{\T})
\end{align*}

\begin{align*}
    E_{i} &= \mqty[0 & \cdots & 0 & I_{2 \times 2} & 0 & \cdots & 0]^{\T}
\end{align*}




$k$-th block column, 
\begin{align*}
    E_{k} &= U \triu(XY^{\T})E_{k} \\
    &= U X Y_{k}^{\T}
\end{align*}


\begin{align*}
    X &\coloneqq U^{-1} E_{k} \\
    % e_{n} &= U x \\
    E_{k} &= U X Y_{k}^{\T} \\
        &= U U^{-1} E_{k} Y_{k}^{\T} \\
        &= E_{k} Y_{k}^{\T} \\
    Y_{k}^{\T} &\coloneqq I_{2 \times 2}
\end{align*}


$(k-1)$-th block column, 

\begin{align*}
    E_{k-1} &= U \triu(XY^{\T})E_{k-1} \\
    &= U \mqty[
        X_{1:k-2}Y_{k-1}^{\T} \\
        \triu(X_{k-1}Y_{k-1}^{\T}) \\
        0_{2 \times 2}
        ]
\end{align*}

$(k-1)$-th block row of $(k-1)$-th block column, 

\begin{align*}
    E_{i}^{\T} E_{j} = 
    \begin{cases}
        I_{2 \times 2}, & \text{if} \ i=j \ ;\\
        0_{2 \times 2}, & \text{otherwise}.
    \end{cases} 
\end{align*}

\begin{align*}
    E_{k-1}^{\T} E_{k-1} = I_{2 \times 2} &= E_{k-1}^{\T} U \mqty[
        X_{1:k-2}Y_{k-1}^{\T} \\
        \triu(X_{k-1}Y_{k-1}^{\T}) \\
        0_{2 \times 2}
        ] \\
        &= \mqty[
            0_{2 \times 2(k-2)} & D_{k-1} & B_{k-1}
        ] \mqty[
            X_{1:k-2}Y_{k-1}^{\T} \\
            \triu(X_{k-1}Y_{k-1}^{\T}) \\
            0_{2 \times 2}
            ] \\
        & = D_{k-1} \triu(X_{k-1}Y_{k-1}^{\T}) \\
        % &= \triu(D_{k-1}X_{k-1}Y_{k-1}^{\T}) \ (\text{as}\  D_{k-1} = \triu(D_{k-1}))\\
    Y_{k-1}^{\T} &\coloneqq (D_{k-1} X_{k-1})^{-1}
\end{align*}

\begin{align*}
    D_{k-1} &= \triu(D_{k-1})\\
    D_{k-1}^{-1} &= \triu(D_{k-1}^{-1})\\
    Y_{k-1}^{\T} &\coloneqq (D_{k-1} X_{k-1})^{-1}\\
    D_{k-1} \triu(X_{k-1}Y_{k-1}^{\T}) &= D_{k-1} \triu(X_{k-1}(D_{k-1} X_{k-1})^{-1})\\
        &= D_{k-1} \triu(X_{k-1} X_{k-1}^{-1} D_{k-1}^{-1})\\
        &= D_{k-1} \triu(D_{k-1}^{-1})\\
        &= D_{k-1} D_{k-1}^{-1}\\
        &= I_{2 \times 2}
\end{align*}


\begin{align*}
    X &\coloneqq U^{-1} E_k\\
    E_{k} &= U X \\
    E_{k}^{\T} E_{k} = I_{2 \times 2} &= E_{k}^{\T} U X \\
        &= \mqty[
            0_{2 \times 2(k-1)} & D_{k}
        ] X \\
        &= D_{k} X_{k} \\
    Y_{k}^{\T} &\coloneqq I_{2 \times 2} \\
        &\coloneqq (D_{k} X_{k})^{-1}
    % y_{n-1} :&= (d_{n-1} x_{n-1})^{-1}
\end{align*}

\begin{align*}
    X &\coloneqq U^{-1} E_{k} \\
    Y_{i}^{\T} &\coloneqq (D_{i} X_{i})^{-1}
\end{align*}









\newpage
$n = 2k + 1$
\begin{align*}
    U &= \mqty[
        \mqty[d_{1}] & \mqty[b^{1}_{1} & b^{2}_{1}] &   &   &  \\
          & \mqty[d_{2} & b^{1}_{2} \\ & d_{3}] & \mqty[b^{2}_{2} & \\ b^{1}_{3} & b^{2}_{3}] &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & \mqty[d_{2k-2} & b^{1}_{2k-2} \\ & d_{2k-1}] & \mqty[b^{2}_{2k-2} & \\ b^{1}_{2k-1} & b^{2}_{2k-1}] \\
          &   &   &   & \mqty[d_{2k} & b^{1}_{2k}\\ & d_{2k+1}]
    ]\\
    &= \mqty[
        \tilde{D_{1}} & \tilde{B_{1}} &   &   &  \\
          & D_{2} & B_{2} &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & D_{k} & B_{k}\\
          &   &   &   & D_{k+1}
    ] \in \mathbb{R}^{(2k+1) \times (2k+1)}
\end{align*}


\begin{align*}
    X &\coloneqq U^{-1} E_{k+1} \\
    Y_{i}^{\T} &\coloneqq (D_{i} X_{i})^{-1} \ \text{for}\ i = 2,\ \cdots,\ k+1 \\
    Y_{1}^{\T} &\coloneqq (D_{1} X_{1})^{+} = (D_{1} X_{1})^{\T} (D_{1} X_{1} (D_{1} X_{1})^{\T})^{-1}
\end{align*}

% \begin{equation}
%     \left[\begin{array}{ll|ll|l}
%     a & b & c & & \\
%     & d & e & f & \\
%     \hline & & g & h & i \\
%     & & j & R \\
%     \hline & & l
%     \end{array}\right]
% \end{equation}






\newpage
\subsection{Banded matrix (Upper)}

$n = ku + r, \ 0\leq r<u$

\begin{align*}
    U &= \mqty[
        d_{1} & b^{1}_{1} & b^{2}_{1} & \cdots & b^{u}_{1} &   &   &   \\
          & d_{2} & b^{1}_{2} & b^{2}_{2} & \cdots & b^{u}_{2} &   &   \\
          &   & \ddots & \ddots & \ddots & \cdots & \ddots &   \\
          &   &   & \ddots & \ddots & \ddots & \cdots & b^{u}_{n-u} \\
          &   &   &   & \ddots & \ddots & \ddots & \vdots \\
          &   &   &   &   & \ddots & \ddots & b^{2}_{n-2} \\
          &   &   &   &   &   & \ddots & b^{1}_{n-1} \\
          &   &   &   &   &   &   & d_{n} \\
    ]\\
    % &= \mqty[
    %     D_{1} & B_{1} &   &   &  \\
    %       & D_{2} & B_{2} &   &  \\
    %       &   & \ddots & \ddots &  \\
    %       &   &   & D_{k} & B_{k}\\
    %       &   &   &   & D_{k+1}
    % ] \in \mathbb{R}^{n \times n} = \mathbb{R}^{(ku + r) \times (ku + r)}
\end{align*}


$r = 0,\ n = ku, $
\begin{align*}
    U &= \mqty[
        D_{1} & B_{1} &   &   &  \\
          & D_{2} & B_{2} &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & D_{k-1} & B_{k-1}\\
          &   &   &   & D_{k}
    ] \in \mathbb{R}^{ku \times ku},\\
    D_{i} &\in \mathbb{R}^{u \times u}, \ B_{i} \in \mathbb{R}^{u \times u} \ \text{for} \ i = 1,\ 2,\ \cdots,\ k.
\end{align*}

\begin{align*}
    X &= \mqty[
        X_{1} \\
        X_{2} \\
        \vdots \\
        X_{k}
        ]
    \in \mathbb{R}^{ku \times u}
    &
    Y &= \mqty[
        Y_{1} \\
        Y_{2} \\
        \vdots \\
        Y_{k}
        ]
    \in \mathbb{R}^{ku \times u}
    &
    Y^{\T} &= \mqty[
        Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k}^{\T}
        ] \in \mathbb{R}^{u \times ku}
\end{align*}


\begin{align*}
    X_{i},\ Y_{i}^{\T} &\in \mathbb{R}^{u \times u},\ \text{for} \ i = 1,\ 2,\ \cdots,\ k \\
    X &\coloneqq U^{-1} E_{k} \\
    Y_{i}^{\T} &\coloneqq (D_{i} X_{i})^{-1}
\end{align*}



$r \neq 0,\ n = ku+r, $
\begin{align*}
    U &= \mqty[
        \tilde{D}_{1} & \tilde{B}_{1} &   &   &  \\
          & D_{2} & B_{2} &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & D_{k} & B_{k}\\
          &   &   &   & D_{k+1}
    ] \in \mathbb{R}^{(ku + r) \times (ku + r)},\\
    \tilde{D}_{1} &\in \mathbb{R}^{r \times r}, \ \tilde{B}_{1} \in \mathbb{R}^{r \times u};\\
    D_{i} &\in \mathbb{R}^{u \times u}, \ B_{i} \in \mathbb{R}^{u \times u} \ \text{for} \ i =  2,\ \cdots,\ k+1.
\end{align*}


\begin{align*}
    X &= \mqty[
        \tilde{X}_{1} \\
        X_{2} \\
        \vdots \\
        X_{k+1}
        ]
    \in \mathbb{R}^{(ku + r) \times u}
    &
    Y &= \mqty[
        \tilde{Y}_{1} \\
        Y_{2} \\
        \vdots \\
        Y_{k+1}
        ]
    \in \mathbb{R}^{(ku + r) \times u}
    &
    Y^{\T} &= \mqty[
        \tilde{Y}_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k+1}^{\T}
        ] \in \mathbb{R}^{u \times (ku + r)}
\end{align*}


\begin{align*}
    \tilde{X}_{1} &\in \mathbb{R}^{r \times u} \\
    \tilde{Y}_{1}^{\T} &\in \mathbb{R}^{u \times r} \\
    X_{i},\ Y_{i}^{\T} &\in \mathbb{R}^{u \times u} \ \text{for} \ i = 2,\ \cdots,\ k+1 \\
    X &\coloneqq U^{-1} E_{k+1} \\
    \tilde{Y}_{1}^{\T} &\coloneqq (D_{1} X_{1})^{+} = (D_{1} X_{1})^{\T} (D_{1} X_{1} (D_{1} X_{1})^{\T})^{-1} \\
    \triu(D_{1} X_{1} \tilde{Y}_{1}^{\T}) &= I_{r \times r}\\
    Y_{i}^{\T} &\coloneqq (D_{i} X_{i})^{-1} \ \text{for}\ i = 2,\ \cdots,\ k+1 
\end{align*}



\newpage

\section{28.06.2022 Meeting formal}

\subsection{Notation}

\noindent This notes use Householder notation and start indexing at one.

\begin{align*}
    \text{Scalars, lower case Greek letters: }& \alpha,\, \beta,\, \gamma,\, \chi,\, etc.\\
    \text{Vectors, lower case Roman letter: }& a,\, b,\, c,\, x,\, etc.\\
    \text{Matrix, upper case Roman letter: }& A,\, B,\, C,\, X,\, etc.\\
\end{align*}

\subsection{Repersentation}

\subsubsection*{Matrix \& Vector}
\begin{align*}
    x   =&
        \begin{bNiceMatrix}[vlines,margin]
            \chi_{1} \\
            \chi_{2} \\
            \Vdots   \\
            \chi_{n} 
        \end{bNiceMatrix} \in \mathbb{R}^{n}\\
    A   =&
        \begin{bNiceMatrix}[vlines,margin]
            \alpha_{11} & \alpha_{12} & \cdots & \alpha_{1n} \\
            \alpha_{21} & \alpha_{22} & \cdots & \alpha_{2n} \\
            \Vdots      & \Vdots      & \Vdots & \Vdots      \\
            \alpha_{m1} & \alpha_{m2} & \cdots & \alpha_{1n} \\
        \end{bNiceMatrix}\\
        =&
        \begin{bNiceMatrix}[vlines,margin]
            a_{1} & a_{2} & \cdots & a_{n} 
        \end{bNiceMatrix}\in \mathbb{R}^{m \times n}\\
\end{align*}

\subsubsection*{Block Matrix \& Block Vector}
\begin{align*}
    x   =&
        \begin{bNiceMatrix}[vlines,margin]
            x_{1} \\
            x_{2} \\
            \Vdots   \\
            x_{n} 
        \end{bNiceMatrix} \in \mathbb{R}^{kn},\, x_{i} \in \mathbb{R}^{k}\\
    A   =&
        \begin{bNiceMatrix}[vlines,margin]
            A_{11} & A_{12} & \cdots & A_{1n} \\
            A_{21} & A_{22} & \cdots & A_{2n} \\
            \Vdots & \Vdots & \Vdots & \Vdots      \\
            A_{m1} & A_{m2} & \cdots & A_{1n} \\
        \end{bNiceMatrix}\\
        =&
        \begin{bNiceMatrix}[vlines,margin]
            A_{1} & A_{2} & \cdots & A_{n} 
        \end{bNiceMatrix}\in \mathbb{R}^{lm \times kn},\, A_{ij} \in \mathbb{R}^{l \times k}
\end{align*}





\newpage
\subsection{Content}


Consider an upper banded matrix $U \in \mathbb{R}^{n \times n}$,

\begin{align}
    U = 
    \begin{bNiceMatrix}[margin]
        \alpha_{1} & \beta^{1}_{1} & \beta^{2}_{1} & \Cdots & \beta^{u}_{1} &   &   &   \\
          & \alpha_{2} & \beta^{1}_{2} & \beta^{2}_{2} & \Cdots & \beta^{u}_{2} &   &   \\
          &   & \Ddots & \Ddots &  &   & \Ddots &   \\
          &   &   &   &   &   &   & \beta^{u}_{n-u} \\
          &   &   &   &   &   &   & \Vdots \\
          &   &   &   &   &   &   & \beta^{2}_{n-2} \\
          &   &   &   &   &   &   & \beta^{1}_{n-1} \\
          &   &   &   &   &   &   & \alpha_{n} \\
    \end{bNiceMatrix}\label{U_banded}.
\end{align}
% \nonumber

\noindent Then try to show that its inverse can be repersent as the upper triangular part of an outer product,
\textit{i.e.}\ ,
\begin{align}
    U^{-1} = \triu(XY^{\T}) \label{main_eqn}
\end{align}

\noindent Let $X,\ Y \in \mathbb{R}^{n \times u}$, consider the following cases of $n$,

\subsection*{Case 1, \bm{$n = ku$}}

then \eqref{U_banded} can be repersent as a block upper bidiagonal matrix,


\NiceMatrixOptions{code-for-first-row = \scriptstyle,code-for-first-col = \scriptstyle}
\setcounter{MaxMatrixCols}{30}
\begin{align}
    U &=
    \begin{bNiceMatrix}[first-row,first-col,margin]
          & \hspace*{1mm} & \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} & \hspace*{1mm} &
            \hspace*{1mm} & \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} & \hspace*{1mm} &
            \hspace*{1mm} & \Cdots & \hspace*{1mm} &
            \hspace*{1mm} & \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} & \hspace*{1mm} \\
        % 
        \hspace*{1mm} &
            \alpha_{1} & \Cdots & \beta^{u-1}_{1} & \beta^{u}_{1} &&&&&&&&\\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &
            & \Ddots & \Vdots & \Vdots & \Ddots &&&&&&&\\
        \hspace*{1mm} &
            && \alpha_{u} & \beta^{1}_{u} & \Cdots & \beta^{u}_{u} &&&&&&\\
        % 
        \hspace*{1mm} &
            &&& \alpha_{u+1} & \Cdots & \beta^{u-1}_{u+1} & \beta^{u}_{u+1} &&&&&\\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &
            &&&& \Ddots & \Vdots & \Vdots & \Ddots &&&&\\
        \hspace*{1mm} &
            &&&&& \alpha_{2u} & \beta^{1}_{2u} & \Cdots & \beta^{u}_{2u} &&&\\
        % 
        \hspace*{1mm} &
            &&&&&&&&&&&\\
        \Vdots &
            &&&&&&  & \ddots &&& \ddots &\\
        \hspace*{1mm} &
            &&&&&&&&&&&\\
        % 
        \hspace*{1mm} &
            &&&&&&&&& \alpha_{(k-1)u+1} & \Cdots & \beta^{u-1}_{(k-1)u+1} \\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &
            &&&&&&&&&& \Ddots & \Vdots \\
        \hspace*{1mm} &
            &&&&&&&&&&& \alpha_{ku}\\
    \end{bNiceMatrix}
    \nonumber \\
    &= 
    \begin{bNiceMatrix}[margin]
        D_{1}   & B_{1} &           &           &  \\
                & D_{2} & B_{2}     &           &  \\
                &       & \ddots    & \ddots    &  \\
                &       &           & D_{k-1}   & B_{k-1}\\
                &       &           &           & D_{k}
    \end{bNiceMatrix}\in \mathbb{R}^{ku \times ku},\, D_{i},\,B_{i} \in \mathbb{R}^{u \times u} \ \text{for} \ i =  1,\, 2,\, \dots,\, k.
    \label{U_block_bi}
\end{align}

\noindent Repersent the $n$-dimensional identity matrix $I_{n \times n}$ in block form,

\begin{align*}
    I_{n \times n} = I_{ku \times ku} = \diag(\underbrace{I_{u \times u},\ I_{u \times u},\ \cdots,\ I_{u \times u}}_{k}) =
    \begin{bNiceMatrix}[vlines,margin]
        E_{1} & E_{2} & \cdots & E_{k}
    \end{bNiceMatrix}.
\end{align*}


\noindent then, its block columns $E_{i}$ for $i =  1,\, 2,\, \dots,\, k$ satisfies

\begin{align*}
    E_{i} &\in \mathbb{R}^{ku \times u} \\
    E_{i}^{\T} E_{j} &= 
    \begin{cases}
        I_{u \times u}, & \text{if} \ i=j \ ;\\
        0_{u \times u}, & \text{otherwise}.
    \end{cases}.
\end{align*}


\noindent To find $X$ and $Y$ such that \eqref{main_eqn} holds, let

\begin{align*}
    X =
    \begin{bNiceMatrix}[margin]
        X_{1} \\
        X_{2} \\
        \vdots \\
        X_{k-1} \\
        X_{k}
    \end{bNiceMatrix} \in \mathbb{R}^{ku \times u},\,
    Y = 
    \begin{bNiceMatrix}[margin]
        Y_{1} \\
        Y_{2} \\
        \vdots \\
        Y_{k-1} \\
        Y_{k}
    \end{bNiceMatrix} \in \mathbb{R}^{ku \times u},\, X_{i},\,Y_{i} \in \mathbb{R}^{u \times u}\ \text{for} \ i =  1,\, 2,\, \dots,\, k,
\end{align*}

\noindent and let $X_{k}$ and $Y_{k}^{\T}$ be upper triangular matrix, 
then $\triu(X_{k} Y_{k}^{\T}) = X_{k} Y_{k}^{\T}$.


\noindent For the outer product form, 

\begin{align*}
    Y^{\T} &=
        \begin{bNiceMatrix}[vlines,margin]
            Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
        \end{bNiceMatrix} \in \mathbb{R}^{u \times ku} \\
    XY^{\T} &=
        \begin{bNiceMatrix}[margin]
            X_{1} \\
            X_{2} \\
            \vdots \\
            X_{k-1} \\
            X_{k}
        \end{bNiceMatrix}
        \begin{bNiceMatrix}[vlines,margin]
            Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
        \end{bNiceMatrix} \\
        &= \begin{bNiceMatrix}[vlines,margin]
            X_{1} Y_{1}^{\T} & X_{1} Y_{2}^{\T} & \cdots & X_{1} Y_{k-1}^{\T} & x_{1} Y_{k}^{\T}\\
            X_{2} Y_{1}^{\T} & X_{2} Y_{2}^{\T} & \cdots & X_{2} Y_{k-1}^{\T} & x_{2} Y_{k}^{\T}\\
            \vdots & \vdots & \vdots & \vdots & \vdots\\
            X_{k-1} Y_{1}^{\T} & X_{k-1} Y_{2}^{\T} & \cdots & X_{k-1} Y_{k-1}^{\T} & X_{k-1} Y_{k}^{\T}\\
            X_{k} Y_{1}^{\T} & X_{k} Y_{2}^{\T} & \cdots & X_{k} Y_{k-1}^{\T} & X_{k} Y_{k}^{\T}
        \end{bNiceMatrix} \\
        &= X
        \begin{bNiceMatrix}[vlines,margin]
            Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
        \end{bNiceMatrix} \\
        &= 
        \begin{bNiceMatrix}[vlines,margin]
            XY_{1}^{\T} & XY_{2}^{\T} & \cdots & XY_{k-1}^{\T} & XY_{k}^{\T}
        \end{bNiceMatrix} \in \mathbb{R}^{ku \times ku},
\end{align*}

\noindent and its the upper triangular componnent,

\begin{align}
    \triu(XY^{\T}) &= 
        \begin{bNiceMatrix}[vlines,margin]
            \triu(X_{1} Y_{1}^{\T}) & X_{1} Y_{2}^{\T} & \cdots & X_{1} Y_{k-1}^{\T} & X_{1} Y_{k}^{\T}\\
            0_{u \times u} & \triu(X_{2} Y_{2}^{\T}) & \cdots & X_{2} Y_{k-1}^{\T} & X_{2} Y_{k}^{\T}\\
            \vdots & \vdots & \vdots & \vdots & \vdots\\
            0_{u \times u} & 0_{u \times u} & \cdots & \triu(X_{k-1} Y_{k-1}^{\T}) & X_{k-1} Y_{k}^{\T}\\
            0_{u \times u} & 0_{u \times u} & \cdots & 0_{u \times u} & X_{k} Y_{k}^{\T}
        \end{bNiceMatrix}
        \nonumber \\
        &= 
        \begin{bNiceMatrix}[vlines,margin]
            \triu(X_{1} Y_{1}^{\T}) & X_{1} Y_{2}^{\T}          &        & X_{1:k-2}Y_{k-1}^{\T}      &  \\
            0_{(k-2)u \times u}     & \triu(X_{2} Y_{2}^{\T})   & \cdots & \triu(X_{k-1}Y_{k-1}^{\T}) & X Y_{k}^{\T}\\
            0_{u \times u}          & 0_{(k-2)u \times u}       &        & 0_{u \times u}             &  
        \end{bNiceMatrix}. \label{triuXYt}
zz\end{align}


\noindent From \eqref{main_eqn},

\begin{align}
    I_{n \times n} = U \triu(XY^{\T}). \label{focus_eqn}
\end{align}


\noindent For $X$ and $Y_{k}$, from \eqref{triuXYt}, the $k$-th block column of \eqref{focus_eqn} can be written as,

\begin{align}
    E_{k} &= U \triu(XY^{\T})E_{k} \nonumber \\
    E_{k} &= U X Y_{k}^{\T} \label{eqnX_ku}
\end{align}


\noindent Define that

\begin{align}
    X &\coloneqq U^{-1} E_{k}; \label{X_ku} \\ 
    Y_{k}^{\T} &\coloneqq I_{u \times u}, \label{Yk_ku}
\end{align}

\noindent which can be shown that \eqref{eqnX_ku} holds for \eqref{X_ku} and \eqref{Yk_ku} as

\begin{align*}
    U X Y_{k}^{\T} &= U U^{-1} E_{k} I_{u \times u} \\
        &= I_{n \times n} E_{k} I_{u \times u} \\
        &= E_{k} I_{u \times u} \\
        &= E_{k}.
\end{align*}


\noindent Then, for $Y_{k-1}$, forming the $(k-1)$-th block column of \eqref{focus_eqn} from \eqref{triuXYt} first,

\begin{align*}
    E_{k-1} &= U \triu(XY^{\T})E_{k-1} \\
    &= U 
    \begin{bNiceMatrix}[margin]
        X_{1:k-2}Y_{k-1}^{\T} \\
        \triu(X_{k-1}Y_{k-1}^{\T}) \\
        0_{u \times u}
    \end{bNiceMatrix}.
\end{align*}

\noindent Focusing on the $(k-1)$-th block row of $(k-1)$-th block column, 


% \begin{bNiceMatrix}[margin]
%     X_{1:k-2}Y_{k-1}^{\T} \\
%     \triu(X_{k-1}Y_{k-1}^{\T}) \\
%     0_{u \times u}
% \end{bNiceMatrix}

\begin{align}
    E_{k-1}^{\T} E_{k-1} &= E_{k-1}^{\T} U 
        \begin{bNiceMatrix}[margin]
            X_{1:k-2}Y_{k-1}^{\T} \\
            \triu(X_{k-1}Y_{k-1}^{\T}) \\
            0_{u \times u}
        \end{bNiceMatrix} \nonumber \\
    I_{u \times u} &=
        \begin{bNiceMatrix}[vlines,margin]
            0_{u \times (k-2)u} & D_{k-1} & B_{k-1}
        \end{bNiceMatrix} 
        \begin{bNiceMatrix}[hlines,margin]
            X_{1:k-2}Y_{k-1}^{\T} \\
            \triu(X_{k-1}Y_{k-1}^{\T}) \\
            0_{u \times u}
        \end{bNiceMatrix} \nonumber \\
    I_{u \times u} &= D_{k-1} \triu(X_{k-1}Y_{k-1}^{\T}) \label{eqnY_k_1u}
\end{align}



\noindent Define that

\begin{align*}
    Y_{k-1}^{\T} &\coloneqq (D_{k-1} X_{k-1})^{-1}
\end{align*}


\begin{align*}
    D_{k-1} &= \triu(D_{k-1})\\
    D_{k-1}^{-1} &= \triu(D_{k-1}^{-1})\\
    Y_{k-1}^{\T} &\coloneqq (D_{k-1} X_{k-1})^{-1}\\
    D_{k-1} \triu(X_{k-1}Y_{k-1}^{\T}) &= D_{k-1} \triu(X_{k-1}(D_{k-1} X_{k-1})^{-1})\\
        &= D_{k-1} \triu(X_{k-1} X_{k-1}^{-1} D_{k-1}^{-1})\\
        &= D_{k-1} \triu(D_{k-1}^{-1})\\
        &= D_{k-1} D_{k-1}^{-1}\\
        &= I_{2 \times 2}
\end{align*}







\begin{align*}
    X &\coloneqq U^{-1} E_k\\
    E_{k} &= U X \\
    E_{k}^{\T} E_{k} = I_{2 \times 2} &= E_{k}^{\T} U X \\
        &= \mqty[
            0_{2 \times 2(k-1)} & D_{k}
        ] X \\
        &= D_{k} X_{k} \\
    Y_{k}^{\T} &\coloneqq I_{2 \times 2} \\
        &\coloneqq (D_{k} X_{k})^{-1}
    % y_{n-1} :&= (d_{n-1} x_{n-1})^{-1}
\end{align*}

\begin{align*}
    X &\coloneqq U^{-1} E_{k} \\
    Y_{i}^{\T} &\coloneqq (D_{i} X_{i})^{-1}
\end{align*}









% hlines,



\newpage
\section{Test}

\begin{align*}
    \begin{bNiceMatrix}
        d_{1} & b^{1}_{1} & b^{2}_{1} & \cdots & b^{u}_{1} &   &   &   \\
          & d_{2} & b^{1}_{2} & b^{2}_{2} & \cdots & b^{u}_{2} &   &   \\
          &   & \ddots & \ddots & \ddots & \cdots & \ddots &   \\
          &   &   & \ddots & \ddots & \ddots & \cdots & b^{u}_{n-u} \\
          &   &   &   & \ddots & \ddots & \ddots & \vdots \\
          &   &   &   &   & \ddots & \ddots & b^{2}_{n-2} \\
          &   &   &   &   &   & \ddots & b^{1}_{n-1} \\
          &   &   &   &   &   &   & d_{n} \\
        \CodeAfter
        \OverBrace[shorten,yshift=3pt]{1-2}{1-5}{\text{bandwidth}=u}
        % \OverBrace[shorten,yshift=3pt]{1-4}{2-6}{B}
    \end{bNiceMatrix}
\end{align*}

%用array环境构造复杂矩阵
$
% @{内容} 添加任意内容，不占表项计数
%  此处添加一个负值空白，表示向左移-5pt的距离,l代表左
\begin{array}{c@{\hspace{-5pt}}l}
%第一行，第一列
\left(\begin{array}{ccc|ccc}
    a   & \cdots & a & b & \cdots &b\\
        & \ddots & \vdots & \vdots & \ddots \\
        &        & a & b \\ \hline
        &        &   & c &\cdots &c \\
        &        &   & \vdots && \vdots \\
    \multicolumn{3}{c|}{\raisebox{2ex}[0pt]{\Huge 0}}
\end{array}\right)
&
%第一行第二列
%效果是两个括号标识符
\begin{array}{l}
%left 仅仅与$\right$配对  ，什么都不输出
\left.\rule{0mm}{7mm}\right\}p\\
\\
\left.\rule{0mm}{7mm}\right\}q\\
\end{array}
\\[-5pt]
%第二行第二列
\begin{array}{cc}
\underbrace{\rule{17mm}{0mm}}_m%\underbrace{text}横向大括号
\underbrace{\rule{17mm}{0mm}}_m%用下划线加字母的方式指定标识符
\end{array}
\end{array}
$



% \NiceMatrixOptions{nullify-dots,code-for-first-col = \color{blue}, code-for-first-row=\color{blue}}
$\begin{pNiceMatrix}[first-row,first-col]
& & \Ldots[line-style={solid,<->},shorten=0pt]^{n \text{ columns}} \\
& 1 & 1 & 1 & \Ldots & 1 \\
& 1 & 1 & 1 & & 1 \\
\Vdots[line-style={solid,<->}]_{n \text{ rows}} & 1 & 1 & 1 & & 1 \\
& 1 & 1 & 1 & & 1 \\
& 1 & 1 & 1 & \Ldots & 1
\end{pNiceMatrix}$


\NiceMatrixOptions{code-for-first-row = \scriptstyle,code-for-first-col = \scriptstyle }
\setcounter{MaxMatrixCols}{12}
\newcommand{\blue}{\color{blue}}
\[\begin{pNiceMatrix}[last-row,last-col,nullify-dots,xdots/line-style={dashed,blue}]
1& & & \Vdots & & & & \Vdots \\
& \Ddots[line-style=standard] \\
& & 1 \\
\Cdots[color=blue,line-style=dashed]& & & \blue 0 &
\Cdots & & & \blue 1 & & & \Cdots & \blue \leftarrow i \\
& & & & 1 \\
& & &\Vdots & & \Ddots[line-style=standard] & & \Vdots \\
& & & & & & 1 \\
\Cdots & & & \blue 1 & \Cdots & & \Cdots & \blue 0 & & & \Cdots & \blue \leftarrow j \\
& & & & & & & & 1 \\
& & & & & & & & & \Ddots[line-style=standard] \\
& & & \Vdots & & & & \Vdots & & & 1 \\
& & & \blue \overset{\uparrow}{i} & & & & \blue \overset{\uparrow}{j} \\
\end{pNiceMatrix}\]




\begin{align*}
    % \NiceMatrixOptions{nullify-dots,code-for-first-col = \color{blue}, code-for-first-row=\color{blue}}
    \begin{pNiceMatrix}[first-row,first-col]
    & & \Ldots[line-style={solid,<->},shorten=0pt]^{n \text{ columns}} \\
    & 1 & 1 & 1 & \Ldots & 1 \\
    & 1 & 1 & 1 & & 1 \\
    \Vdots[line-style={solid,<->}]_{n \text{ rows}} & 1 & 1 & 1 & & 1 \\
    & 1 & 1 & 1 & & 1 \\
    & 1 & 1 & 1 & \Ldots & 1
    \end{pNiceMatrix}
\end{align*}



\begin{align*}
    \begin{pNiceMatrix}
        \Block[borders={bottom,right,tikz=dashed}]{2-2}{}
        1 & 2 & 0 & 0 & 0 & 0 \\
        4 & 5 & 0 & 0 & 0 & 0 \\
        0 & 0 & \Block[borders={bottom,top,right,left,tikz=dashed}]{2-2}{}
        7 & 1 & 0 & 0 \\
        0 & 0 & -1 & 2 & 0 & 0 \\
        0 & 0 & 0 & 0 & \Block[borders={left,top,tikz=dashed}]{2-2}{}
        3 & 4 \\
        0 & 0 & 0 & 0 & 1 & 4
    \end{pNiceMatrix}
\end{align*}

\begin{align*}
    &\begin{bNiceMatrix}
        \Block[borders={bottom,right,tikz=dashed}]{2-2}{}
        d_{1} & b^{1}_{1} & 
        \Block[borders={bottom,right,tikz=dashed}]{2-2}{}
        b^{2}_{1} &   &   &   &   &   &   &   \\
          & d_{2} & b^{1}_{2} & b^{2}_{2} &   &   &   &   &   &  \\
          &   & \Block[borders={bottom,right,left,tikz=dashed}]{2-2}{}
        d_{3} & b^{1}_{3} & \Block[borders={bottom,top,right,tikz=dashed}]{2-2}{}
        b^{2}_{3} &   &   &   &   &  \\
          &   &   & d_{4} & b^{1}_{4} & b^{2}_{4} &   &   &   &  \\
          &   &   &   & \Block[borders={left,right,bottom,tikz=dashed}]{2-2}{}
        \ddots &   & \Block[borders={bottom,top,right,tikz=dashed}]{2-2}{}
        \ddots &   &   &  \\
          &   &   &   &   & \ddots &   & \ddots &   &  \\
          &   &   &   &   &   & \Block[borders={left,right,bottom,tikz=dashed}]{2-2}{}
        d_{2k-3} & b^{1}_{2k-3} & \Block[borders={bottom,top,tikz=dashed}]{2-2}{}
        b^{2}_{2k-3} &  \\
          &   &   &   &   &   &   & d_{2k-2} & b^{1}_{2k-2} & b^{2}_{2k-2}\\
          &   &   &   &   &   &   &   & \Block[borders={left,tikz=dashed}]{2-2}{}
        d_{2k-1} & b^{1}_{2k-1}\\
          &   &   &   &   &   &   &   &   & d_{2k}
    \end{bNiceMatrix}\\
    &= \mqty[
        \mqty[d_{1} & b^{1}_{1} \\ & d_{2}] & \mqty[b^{2}_{1} &  \\ b^{1}_{2} & b^{2}_{2}] &   &   &  \\
          & \mqty[d_{3} & b^{1}_{3} \\ & d_{4}] & \mqty[b^{2}_{3} & \\ b^{1}_{4} & b^{2}_{4}] &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & \mqty[d_{2k-3} & b^{1}_{2k-3} \\ & d_{2k-2}] & \mqty[b^{2}_{2k-3} & \\ b^{1}_{2k-2} & b^{2}_{2k-2}] \\
          &   &   &   & \mqty[d_{2k-1} & b^{1}_{2k-1}\\ & d_{2k}]
    ]\\
\end{align*}

\begin{align*}
    \begin{bNiceMatrix}
        1 & 2 & 0 & 0 & 0 & 0 \\
        4 & 5 & 0 & 0 & 0 & 0 \\
        0 & 0 & 7 & 1 & 0 & 0 \\
        0 & 0 & 1 & 2 & 0 & 0 \\
        0 & 0 & 0 & 0 & 3 & 4 \\
        0 & 0 & 0 & 0 & 1 & 4
        \CodeAfter
        \SubMatrix[{1-1}{3-3}]
        \SubMatrix[{1-4}{3-4}]
    \end{bNiceMatrix}
\end{align*}

\begin{align*}
    \begin{bNiceMatrix}
        d_{1}       & b^{1}_{1} & \Cdots & b^{r-2}_{1} & b^{r-1}_{1} \\
                    & d_{2}     &       &   & b^{r-2}_{2} \\
                    &           & \Ddots    &   & \Vdots \\
                    &           &       & d_{r-1} & b^{1}_{r-1} \\
                    &           &   &   & d_{r}
    \end{bNiceMatrix}
    & \begin{bNiceMatrix}
        b^{r}_{1}   & \Cdots    & b^{u}_{1} &   &   &   &   &   &   \\
        b^{r-1}_{2} & b^{r}_{2} &           & b^{u}_{2} &   &   &   &   &   \\
        \Vdots      &           & \Ddots    &   &  \\
        b^{2}_{r-1} \\
        b^{1}_{r}   & b^{2}_{r} & \Cdots    & b^{u}_{r} 
    \end{bNiceMatrix}\\
     & \begin{bNiceMatrix}
        d_{1} & b^{1}_{1} & \Cdots & b^{r-2}_{1} & b^{r-1}_{1} \\
        0 & d_{2} &   &   & b^{r-2}_{2} \\
        \Vdots & \Ddots[draw-first] & \Ddots &   & \Vdots \\
          &   &   & d_{r-1} & b^{1}_{r-1} \\
        0 & \Cdots &   & 0 & d_{r}
    \end{bNiceMatrix}\\
\end{align*}



\begin{align*}
    \begin{bNiceMatrix}
        d_{1}       & b^{1}_{1}   & \Cdots      & b^{r-2}_{1} & b^{r-1}_{1} \\
                    & d_{2}       &             &             & b^{r-2}_{2} \\
                    &             & \Ddots      &             & \Vdots      \\
                    &             &             & d_{r-1}     & b^{1}_{r-1} \\
                    &             &             &             & d_{r}       \\
    \end{bNiceMatrix}
    &
    \begin{bNiceMatrix}
        b^{r}_{1}   & b^{r+1}_{1} & \Cdots      & b^{u-1}_{1} & b^{u}_{1}  &             &             &             &             \\
        b^{r-1}_{2} &             &             &             &            & b^{u}_{2}   &             &             &             \\
        \Vdots      &             &             &             &            &             &  \Ddots     &             &             \\
        b^{2}_{r-1} &             &             &             &            &             &             & b^{u}_{r-1} &             \\
        b^{1}_{r}   & b^{2}_{r}   & \Cdots      &             &            &             &             & b^{u-1}_{r} & b^{u}_{r}   \\
    \end{bNiceMatrix}
\end{align*}

\begin{align*}
    \begin{bNiceMatrix}
        d_{1}       & \Cdots      & b^{r-1}_{1} \\
                    & \Ddots      & \Vdots      \\
                    &             & d_{r}       
    \end{bNiceMatrix}
    &
    \begin{bNiceMatrix}
        b^{r}_{1}   & \Cdots      & b^{u}_{1}  &             &             \\
        \Vdots      &             &            & \Ddots      &             \\
        b^{1}_{r}   & \Cdots      &            &             & b^{u}_{r}   \\
    \end{bNiceMatrix}
    & \\
    &
     \begin{bNiceMatrix}
        b^{r}_{1}   & \Cdots      & b^{u}_{1}  &             &             \\
        \Vdots      &             &            & \Ddots      &             \\
        b^{1}_{r}   & \Cdots      &            &             & b^{u}_{r}   \\
    \end{bNiceMatrix}
    &
    \begin{bNiceMatrix}
        b^{r}_{1}   & \Cdots      & b^{u}_{1}  &             &             \\
        \Vdots      &             &            & \Ddots      &             \\
        b^{1}_{r}   & \Cdots      &            &             & b^{u}_{r}   \\
    \end{bNiceMatrix}
\end{align*}


\begin{align*}
    \begin{bNiceMatrix}
        d_{1}       & \Cdots & b^{r-1}_{1} & b^{r}_{1}   & \Cdots & b^{u}_{1}  &        &               \\
                    & \Ddots & \Vdots      & \Vdots      &        &            & \Ddots &               \\
                    &        & d_{r}       & b^{1}_{r}   & \Cdots &            &        & b^{u}_{r}     \\
                    &        &             & d_{r+1}     & \Cdots &            &        & b^{u-1}_{r+1} \\
                    &        &             &             &        &            &        &               \\
                    &        &             &             &        & \Ddots     &        & \Vdots        \\
                    &        &             &             &        &            &        &               \\
                    &        &             &             &        &            &        & d_{r+u}       \\
    \end{bNiceMatrix}
\end{align*}


% \NiceMatrixOptions{code-for-first-row = \scriptstyle,code-for-first-col = \scriptstyle}
% \setcounter{MaxMatrixCols}{30}
% \begin{align*}
%     \begin{bNiceMatrix}[first-row,first-col]
%           & \underset{\downarrow}{1} & \Cdots & \underset{\downarrow}{r} & \underset{\downarrow}{r+1} & \Cdots & \underset{\downarrow}{u} & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18\\
%         1 \rightarrow & d_{1} & \Cdots & b^{r-1}_{1} & b^{r}_{1} & \Cdots & b^{u}_{1} &&&&&&&&&&&&\\
%         \Vdots[line-style={solid,<->}]_{r} && \Ddots & \Vdots & \Vdots &&& \Ddots &&&&&&&&&&&\\
%         r \rightarrow &&& d_{r} & b^{1}_{r} & \Cdots &&& b^{u}_{r} &&&&&&&&&&\\
%         % 
%         1+r \rightarrow &&&& d_{1+r} & \Cdots &   &   & b^{u-1}_{1+r} & b^{u}_{r+1} &&&&&&&&&\\
%           &&&&&&&&&&&&&&&&&&\\
%         \Vdots[line-style={solid,<->}]_{u} &&&&&& \Ddots && \Vdots & \Vdots && \Ddots &&&&&&&\\
%           &&&&&&&&&&&&&&&&&&\\
%         u+r \rightarrow  &&&&&&&& d_{u+r} & b^{1}_{u+r} && \Cdots && b^{u}_{u+r} &&&&&\\
%         % 
%           &&&&&&&&& \hspace*{5mm} &&& \Cdots && \hspace*{5mm} & \hspace*{5mm} &&&\\
%           &&&&&&&&&&&&&&&&&&\\
%           &&&&&&&&&&& \Ddots && \Vdots & \Vdots && \Ddots &&\\
%           &&&&&&&&&&&&&&&&&&\\
%           &&&&&&&&&&&&& \hspace*{5mm} & \hspace*{5mm} && \Cdots && \hspace*{5mm}\\
%         % 
%         n-u+1 \rightarrow &&&&&&&&&&&&&& d_{n-u+1} && \Cdots && b^{u}_{n-u+1}\\
%          &&&&&&&&&&&&&&&&&&  \\
%         \Vdots[line-style={solid,<->}]_{u} &&&&&&&&&&&&&&&& \Ddots && \Vdots \\
%         a &&&&&&&&&&&&&&&&&&  \\
%         n \rightarrow &&&&&&&&&&&&&&&&&& d_{n}\\
%     \end{bNiceMatrix}
% \end{align*}



\NiceMatrixOptions{code-for-first-row = \scriptstyle,code-for-first-col = \scriptstyle}
\setcounter{MaxMatrixCols}{30}
\begin{align*}
    \begin{bNiceMatrix}[first-row,first-col]
          & \hspace*{1mm} & \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$r$\end{turn}} & \hspace*{1mm}
          & \hspace*{1mm} && \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} && \hspace*{1mm}
          & \hspace*{1mm} && \Cdots && \hspace*{1mm}
          & \hspace*{1mm} && \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} && \hspace*{1mm}\\
        \hspace*{1mm} & d_{1} & \Cdots & b^{r-1}_{1} & b^{r}_{1} & \Cdots & b^{u}_{1} &&&&&&&&&&&&\\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$r$\end{sideways}} && \Ddots & \Vdots & \Vdots &&& \Ddots &&&&&&&&&&&\\
        \hspace*{1mm} &&& d_{r} & b^{1}_{r} & \Cdots &&& b^{u}_{r} &&&&&&&&&&\\
        % 
        \hspace*{1mm} &&&& d_{1+r} & \Cdots &   &   & b^{u-1}_{1+r} & b^{u}_{r+1} &&&&&&&&&\\
          &&&&&&&&&&&&&&&&&&\\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &&&&&& \Ddots && \Vdots & \Vdots && \Ddots &&&&&&&\\
          &&&&&&&&&&&&&&&&&&\\
        \hspace*{1mm}  &&&&&&&& d_{u+r} & b^{1}_{u+r} && \Cdots && b^{u}_{u+r} &&&&&\\
        % 
        \hspace*{1mm} &&&&&&&&& \hspace*{5mm} &&& \Cdots && \hspace*{5mm} & \hspace*{5mm} &&&\\
          &&&&&&&&&&&&&&&&&&\\
        \Vdots &&&&&&&&&&& \Ddots && \Vdots & \Vdots && \Ddots &&\\
          &&&&&&&&&&&&&&&&&&\\
        \hspace*{1mm} &&&&&&&&&&&&& \hspace*{5mm} & \hspace*{5mm} && \Cdots && \hspace*{5mm}\\
        % 
        \hspace*{1mm} &&&&&&&&&&&&&& d_{n-u+1} && \Cdots && b^{u}_{n-u+1}\\
         &&&&&&&&&&&&&&&&&&  \\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &&&&&&&&&&&&&&&& \Ddots && \Vdots \\
         &&&&&&&&&&&&&&&&&&  \\
        \hspace*{1mm} &&&&&&&&&&&&&&&&&& d_{n}\\
    \end{bNiceMatrix}
\end{align*}


\NiceMatrixOptions{code-for-first-row = \scriptstyle,code-for-first-col = \scriptstyle}
\setcounter{MaxMatrixCols}{30}
\begin{align*}
    \begin{bNiceMatrix}[first-row,first-col]
          & \hspace*{1mm} && \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} && \hspace*{1mm}
          & \hspace*{1mm} && \Cdots && \hspace*{1mm}
          & \hspace*{1mm} && \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} && \hspace*{1mm}\\
        % 
        \hspace*{1mm} & d_{1} & \Cdots &   &   & b^{u-1}_{1} & b^{u}_{r+1} &&&&&&&&&\\
          &&&&&&&&&&&&&&&\\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &&& \Ddots && \Vdots & \Vdots && \Ddots &&&&&&&\\
          &&&&&&&&&&&&&&&\\
        \hspace*{1mm}  &&&&& d_{u} & b^{1}_{u} && \Cdots && b^{u}_{u} &&&&&\\
        % 
        \hspace*{1mm} &&&&&& \hspace*{5mm} &&& \Cdots && \hspace*{5mm} & \hspace*{5mm} &&&\\
          &&&&&&&&&&&&&&&&\\
        \Vdots &&&&&&&& \Ddots && \Vdots & \Vdots && \Ddots &&\\
          &&&&&&&&&&&&&&&\\
        \hspace*{1mm} &&&&&&&&&& \hspace*{5mm} & \hspace*{5mm} && \Cdots && \hspace*{5mm}\\
        % 
        \hspace*{1mm} &&&&&&&&&&& d_{n-u+1} && \Cdots && b^{u}_{n-u+1}\\
         &&&&&&&&&&&&&&&  \\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &&&&&&&&&&&&& \Ddots && \Vdots \\
         &&&&&&&&&&&&&&&  \\
        \hspace*{1mm} &&&&&&&&&&&&&&& d_{n}\\
    \end{bNiceMatrix}
\end{align*}


% \begin{sideways}将要打印的内容旋转90度\end{sideways}
% \begin{turn}{45}将要打印的内容旋转自定义角度\end{turn}
% \begin{rotate}{120}将要打印的内容旋转自定义角度，但是旋转结果并不能保证被旋转对象所需要的空间\end{rotate}


\NiceMatrixOptions{
    code-for-first-row = \scriptstyle,
    code-for-last-col = \scriptstyle
    }
\begin{align*}
    \begin{bNiceMatrix}[vlines,first-row,last-col]
        1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
        1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
        1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
        1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
        1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
        1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
    \end{bNiceMatrix}
\end{align*}

\NiceMatrixOptions{
    code-for-first-row = \scriptstyle,
    code-for-first-col = \scriptstyle,
    code-for-last-row = \scriptstyle,
    code-for-last-col = \scriptstyle
    }
\setcounter{MaxMatrixCols}{30}
\begin{align*}
    \begin{bNiceMatrix}[first-row,first-col,last-row,last-col]
        0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 \\
        0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 \\
        0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 \\
        0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 \\
    \end{bNiceMatrix}
\end{align*}


\NiceMatrixOptions{
    code-for-first-row = \scriptstyle,
    code-for-first-col = \scriptstyle,
    }
\setcounter{MaxMatrixCols}{30}
\begin{align*}
    \begin{bNiceMatrix}[first-row,first-col]
        % \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$1$\end{turn}}
        % \Vdots[line-style={solid,<->}]_{\begin{sideways}$1$\end{sideways}}
          && \hspace*{1mm} & \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} &&&\hspace*{1mm} 
        &&&&&&\\
         & d_{1} & b^{1}_{1} & b^{2}_{1} & \Cdots && b^{u}_{1} &&&&&&\\
        \hspace*{1mm} & b^{-1}_{1} & d_{2} & \Ddots &&&& \Ddots &&&&&\\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$l$\end{sideways}}
            & b^{-2}_{1} & \Ddots & \Ddots &&&&&&&&&\\
         & \Vdots &&&&&&&&&&&\\
        \hspace*{1mm} & b^{-l}_{1} &&&&&&&&&&&\\
         && \Ddots &&&&&&&&&&\\
         &&&&&&&&&&&& b^{u}_{n-u}\\
         &&&&&&&&&&&&  \\
         &&&&&&&&&&&& \Vdots \\
         &&&&&&&&&&&& b^{2}_{n-2}\\
         &&&&&&&&&&&& b^{1}_{n-1}\\
         &&&&&&&& b^{-l}_{n-l} & \Cdots & b^{-2}_{n-2} & b^{-1}_{n-1} & d_{n}\\
    \end{bNiceMatrix}
\end{align*}





\end{document}




