\documentclass[11pt]{article}
% \documentclass{article}


% 中文 \documentclass[UTF8]{ctexart}
% 编译快捷键：Command+Option+B

% 显示快捷键：Command+Option+V

% 正向搜索：选中代码Command+Option+J

% 反向搜索：shift+command点击预览PDF



\usepackage[utf8]{inputenc}


\usepackage{graphicx}


\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{mathrsfs}
\usepackage{bm}

\usepackage{nicematrix}
\usepackage{tikz}
\usepackage{physics}


\usepackage{enumerate}
\usepackage{hyperref}

\usepackage{verbatim}
\usepackage{url}
% \usepackage{listings}
\usepackage{color} %red, green, blue, yellow, cyan, magenta, black, white


\usepackage{rotating}


\usepackage[english]{babel}



\usepackage{mathtools}


\usepackage{geometry}

% \geometry{a4paper,scale=0.8}

\geometry{a4paper,left=2cm,right=2cm,top=2cm,bottom=3cm}

\usepackage{graphicx}
\usepackage{float}


% \usepackage[usefamily={julia,jl}]{pythontex}
\usepackage{dsfont}
\usepackage{bbm}

\newcommand{\diag}{\mathop{\mathrm{diag}}}

\newcommand{\triu}{\mathop{\mathrm{triu}}}
\newcommand{\tril}{\mathop{\mathrm{tril}}}
\newcommand{\T}{\mathrm{T}}

% \newcommand{\redtext}[1]{\textcolor{red}{#1}}

\newcommand{\bigzero}{\mbox{\normalfont\Large\bfseries 0}}
\newcommand{\rvline}{\hspace*{-\arraycolsep}\vline\hspace*{-\arraycolsep}}





\title{\textbf{Thesis Contents}}
\author{\textit{Zhiwei Zhou}}
% \date{April 2022}




% \usepackage{color}
% \usepackage{xcolor}





\begin{document}

\maketitle


\section*{Abstract}
\section*{Acknowledgments}
\section*{Contents}
\section{List of Symbols}


\section{List of Figures}


\section{List of Tables}





\section{Introduction}


\subsection{Basic Definition}

\subsection{Vector and Matrix Norm}

\subsection{Floating Point System}

\subsection{Floating Point Arithmetic}

\subsection{Matrix decompositions}

\subsection{Forward an Backward Errors}


\section{Background(Literature review)}

\section{Derivation}


\section{Algorithms}


\subsection{Improvement(expmodified)}

\section{Application}


\section{Numerical Expriment}


\section{Conclusion}

\section{Futrue Work}

\section*{References}

\section*{Appendix}

\newpage



\section{Julia code (Appendix)}






% General text:
% \qqtext \qq{} general quick quad text with argument
% \qq{word or phrase} → word or phrase normal mode; left and right \quad
% \qq*{word or phrase} → word or phrase starred mode; right \quad only

% Special macros:
% \qcomma or \qc →, right \quad only
% \qcc → c.c. complex conjugate; left and right \quad unless starred \qcc* → c.c.

% \qif → if left and right \quad unless starred \qif* → if
% Similar to \qif:
% \qthen, \qelse, \qotherwise, \qunless, \qgiven, \qusing, \qassume, \qsince,
% \qlet, \qfor, \qall, \qeven, \qodd, \qinteger, \qand, \qor, \qas, \qin


\section{Semiseparable}

Define matrices $E_{u}(p)$ and $E_{l}(q)$ as following,

\begin{align}
    E_{u}(p) = \begin{cases}
        1\qc &  \qif* i \leqslant j - p, \\ 
        0\qc &  \text{otherwise}.
    \end{cases}
    \qand
    E_{l}(q) = \begin{cases}
        1\qc &  \qif* i \geqslant j - q, \\ 
        0\qc &  \text{otherwise}.
    \end{cases}.
\end{align}


i.e.
\begin{align}
    E_{u}(-1) &=
    \begin{bNiceMatrix}[margin]
        1      & 1      &        & \Cdots & 1 \\
        1      & \Ddots & \Ddots &        & \Vdots \\
        0      & \Ddots & \Ddots & \Ddots &   \\
        \Vdots & \Ddots & \Ddots & \Ddots & 1 \\
        0      & \Cdots & 0      & 1      & 1
    \end{bNiceMatrix},
    & E_{u}(0) &=
    \begin{bNiceMatrix}[margin]
        1      & 1      &        & \Cdots & 1 \\
        0      & \Ddots & \Ddots &        & \Vdots \\
               & \Ddots & \Ddots & \Ddots &   \\
        \Vdots &        & \Ddots & \Ddots & 1 \\
        0      & \Cdots &        & 0      & 1
    \end{bNiceMatrix},
    & E_{u}(1) &=
    \begin{bNiceMatrix}[margin]
        0      & 1      &        & \Cdots & 1 \\
               & \Ddots & \Ddots &        & \Vdots \\
               &        & \Ddots & \Ddots &   \\
        \Vdots &        &        & \Ddots & 1 \\
        0      & \Cdots &        &        & 0
    \end{bNiceMatrix};\\
    E_{l}(-1) &=
    \begin{bNiceMatrix}[margin]
        1      & 1      & 0      & \Cdots & 0 \\
        1      & \Ddots & \Ddots & \Ddots & \Vdots \\
               & \Ddots & \Ddots & \Ddots & 0 \\
        \Vdots &        & \Ddots & \Ddots & 1 \\
        1      & \Cdots &        & 1      & 1
    \end{bNiceMatrix},
    & E_{l}(0) &=
    \begin{bNiceMatrix}[margin]
        1      & 0      &        & \Cdots & 0 \\
        1      & \Ddots & \Ddots &        & \Vdots \\
               & \Ddots & \Ddots & \Ddots &   \\
        \Vdots &        & \Ddots & \Ddots & 0 \\
        1      & \Cdots &        & 1      & 1
    \end{bNiceMatrix},
    & E_{l}(1) &=
    \begin{bNiceMatrix}[margin]
        0      &        &        & \Cdots & 0 \\
        1      & \Ddots &        &        & \Vdots \\
               & \Ddots & \Ddots &        &   \\
        \Vdots &        & \Ddots & \Ddots &   \\
        1      & \Cdots &        & 1      & 0
    \end{bNiceMatrix}.
\end{align}

where $|p| \leqslant n-1$ and $|q| \leqslant n-1$.
\\

Define the operations $\triu$ and $\tril$, 
\begin{align}
    \triu\left( A , p \right) &= A \circ E_{u}(p) \\
    \tril\left( A , q \right) &= A \circ E_{l}(q)
\end{align}

$i.e.$ $\triu\left( A , p \right)$ retains the entries of $A$ above the $p$-th super-diagonal (inclusive) 
and makes the entries of $A$ below the $p$-th super-diagonal (exclusive) 0.






define symmetric \{1,1\}-semiseparable matrix, $S$

\begin{align}
    S &= \begin{cases}
        x_{i} y_{j} &  \text{if } i \leqslant j \ ; \\ 
        x_{j} y_{i} &  \text{if } i \geqslant j .
    \end{cases}\\
    &= \triu\left(x y^{\T}\right) + \tril\left(y x^{\T}, -1\right) \\
    &= \triu\left(x y^{\T}, 1\right) + \tril\left(y x^{\T}\right) \\
    &=
    \begin{bNiceMatrix}[margin]
        x_{1} y_{1} & x_{1} y_{2} & \cdots & x_{1} y_{n} \\
        x_{1} y_{2} & x_{2} y_{2} & \cdots & x_{2} y_{n} \\
        \vdots      & \vdots      & \ddots & \vdots      \\
        x_{1} y_{n} & x_{2} y_{n} & \cdots & x_{n} y_{n} 
    \end{bNiceMatrix}
\end{align}










\newpage

\section{Matrix (basic def)}

\subsection*{Matrix-Matrix Multiplication}
\begin{align}
    AB &= C \\
    c_{ij} &= \sum_{k=1}^{n} a_{ik} b_{kj}
\end{align}

\subsection*{Matrix-Vector Multiplication}
\begin{align}
    Ax &= b \\
    b_{i} &= \sum_{k=1}^{n} a_{ik} x_{k}
\end{align}


\newpage
\section{Algorithm (Appendix)}

\subsection*{Backward Subsitution}

\begin{equation}
    Ux = b
\end{equation}


\subsubsection*{Triangular Matrix}


\begin{align}
% \begin{equation}
% \begin{aligned}
    \begin{bNiceMatrix}[margin] %hlines,
        d_1 & u_{1}^{1} & u_{1}^{2} & \cdots & \cdots & u_{1}^{n-1} \\
            & d_2 & u_{2}^{1} & u_{2}^{2} & \cdots & u_{2}^{n-2} \\
        && \ddots & \ddots & \ddots & \vdots\\
        &&& d_{n-2} & u_{n-2}^{1} & u_{n-2}^{2} \\
        &&&& d_{n-1} & u_{n-1}^{1} \\
        &&&&& d_n
    \end{bNiceMatrix}
    \begin{bNiceMatrix}[margin] %hlines,
        x_1 \\ x_2 \\ \vdots \\ x_{n-2} \\ x_{n-1} \\ x_n
    \end{bNiceMatrix}
    &=
    \begin{bNiceMatrix}[margin] %hlines,
        b_1 \\ b_2 \\ \vdots \\ b_{n-2} \\ b_{n-1} \\ b_n
    \end{bNiceMatrix}
% \end{aligned}
% \end{equation}
\end{align}

% \begin{align}
%         \begin{bNiceMatrix}[margin]
%             d_{1} & u^{1}_{1} & u^{2}_{1} & \Cdots &   &   &   & u^{n-1}_{1}  \\
%               & d_{2} & u^{1}_{2} & u^{2}_{2} & \Cdots &   &   & u^{n-2}_{2} \\
%               &   & \Ddots & \Ddots & \Ddots &   &    & \Vdots \\
%               &   &   &   &   &   &   &  \\
%               &   &   &   &   &   &   &  \\
%               &   &   &   &   & d_{n-2} & u_{n-2}^{1} & u_{n-2}^{2} \\
%               &   &   &   &   &   & d_{n-1} & u_{n-1}^{1} \\
%               &   &   &   &   &   &   & d_{n} \\
%         \end{bNiceMatrix}
%         \begin{bNiceMatrix}[margin] %hlines,
%             x_1 \\ x_2 \\ \Vdots \\ \\ \\ x_{n-2} \\ x_{n-1} \\ x_n
%         \end{bNiceMatrix}
%         &=
%         \begin{bNiceMatrix}[margin] %hlines,
%             b_1 \\ b_2 \\ \Vdots \\ \\ \\ b_{n-2} \\ b_{n-1} \\ b_n
%         \end{bNiceMatrix}
% \end{align}

\begin{align}
    x_{n} &= b_{n} / u_{n n} \\
    x_{i} &= \left.\left(b_{i}-\sum_{j=i+1}^{n} u_{i j} x_{j}\right) \right/ u_{i i}
\end{align}

\begin{align}
    d_{n} x_{n} &= b_{n} & 
        &\Rightarrow &
        x_{n} &= \left. b_{n} \right/ d_{n} \\
    d_{n-1} x_{n-1}+u_{n-1}^{1} x_{n} &= b_{n-1} &
        &\Rightarrow &
        x_{n-1} &= \left.\left(b_{n-1}-u_{n-1}^{1} x_{n}\right) \right/ d_{n-1} \\
    d_{n-2} x_{n-2}+u_{n-2}^{1} x_{n-1}+u_{n-2}^{2} x_{n} &= b_{n-2} &
        &\Rightarrow &
        x_{n-2} &= \left.\left(b_{n-2}-u_{n-2}^{1} x_{n-1}-u_{n-2}^{2} x_{n}\right) \right/ d_{n-2} \\
    & &
        &\ \ \vdots &
    & &
\end{align}

% \begin{align}
%     b_{n} &= d_{n} x_{n} & 
%         &\Rightarrow &
%         x_{n} &= \left. b_{n} \right/ d_{n} \\
%     b_{n-1} &= d_{n-1} x_{n-1}+u_{n-1}^{1} x_{n} &
%         &\Rightarrow &
%         x_{n-1} &= \left.\left(b_{n-1}-u_{n-1}^{1} x_{n}\right) \right/ d_{n-1} \\
%     b_{n-2} &= d_{n-2} x_{n-2}+u_{n-2}^{1} x_{n-1}+u_{n-2}^{2} x_{n} &
%         &\Rightarrow &
%         x_{n-2} &= \left.\left(b_{n-2}-u_{n-2}^{1} x_{n-1}-u_{n-2}^{2} x_{n}\right) \right/ d_{n-2} \\
%     & &
%         &\ \ \vdots &
%     & &
% \end{align}

\begin{align}
    b_{n-k} &= d_{n-k} x_{n-k}+u_{n-k}^{1} x_{n-k+1}+u_{n-k}^{2} x_{n-k+2} + \cdots u_{n-k}^{k} x_{n-k+k}\\
    \Rightarrow \quad x_{n-k} &= \left.\left(b_{n-k}-u_{n-k}^{1} x_{n-k+1}-u_{n-k}^{2} x_{n-k+2} - \cdots
        u_{n-k}^{k} x_{n-k+k}\right) \right/ d_{n-k}\\
        &= \left.\left(b_{n-k}-\sum_{j=1}^{k} u_{n-k}^{j} x_{n-k+j}\right) \right/ d_{n-k} \\
\end{align}


\begin{align}
    x_{i} &= \left.\left(b_{i}-\sum_{j=1}^{n-i} u_{i}^{j} x_{i+j}\right) \right/ d_{i} \\
    x_{i} &= \left.\left(b_{i}-\sum_{j=i+1}^{n} u_{i j} x_{j}\right) \right/ u_{i i}
\end{align}



\subsubsection*{Upper Banded Matrix}


\begin{align}
    \begin{bNiceMatrix}[margin]
        d_{1} & b^{1}_{1} & b^{2}_{1} & \cdots & b^{u}_{1} &   &   &   \\
          & d_{2} & b^{1}_{2} & b^{2}_{2} & \cdots & b^{u}_{2} &   &   \\
          &   & \ddots & \ddots & \ddots &   & \ddots &   \\
          &   &   & \ddots & \ddots & \ddots &   & b^{u}_{n-u} \\
          &   &   &   & \ddots & \ddots & \ddots & \vdots \\
          &   &   &   &   & d_{n-2} & b_{n-2}^{1} & b^{2}_{n-2} \\
          &   &   &   &   &   & d_{n-1} & b^{1}_{n-1} \\
          &   &   &   &   &   &   & d_{n} 
    \end{bNiceMatrix}
    \begin{bNiceMatrix}[margin] %hlines,
        x_1 \\ x_2 \\
        \vdots \\ \vdots \\ \vdots \\
        x_{n-2} \\ x_{n-1} \\ x_n
    \end{bNiceMatrix}
    &=
    \begin{bNiceMatrix}[margin] %hlines,
        b_1 \\ b_2 \\
        \vdots \\ \vdots \\ \vdots \\
        b_{n-2} \\ b_{n-1} \\ b_n
    \end{bNiceMatrix}
\end{align}


\begin{align}
    x_{n} &= b_{n} / u_{n n} \\
    x_{i} &= \left.\left(b_{i}-\sum_{j=i+1}^{n} u_{i j} x_{j}\right) \right/ u_{i i}
\end{align}

\begin{align}
    d_{n} x_{n} &= b_{n} & 
        &\Rightarrow &
        x_{n} &= \left. b_{n} \right/ d_{n} \\
    d_{n-1} x_{n-1}+u_{n-1}^{1} x_{n} &= b_{n-1} &
        &\Rightarrow &
        x_{n-1} &= \left.\left(b_{n-1}-u_{n-1}^{1} x_{n}\right) \right/ d_{n-1} \\
    d_{n-2} x_{n-2}+u_{n-2}^{1} x_{n-1}+u_{n-2}^{2} x_{n} &= b_{n-2} &
        &\Rightarrow &
        x_{n-2} &= \left.\left(b_{n-2}-u_{n-2}^{1} x_{n-1}-u_{n-2}^{2} x_{n}\right) \right/ d_{n-2} \\
    & &
        &\ \ \vdots &
    & &
\end{align}


\begin{align}
    b_{n-k} &= d_{n-k} x_{n-k}+u_{n-k}^{1} x_{n-k+1}+u_{n-k}^{2} x_{n-k+2} + \cdots u_{n-k}^{k} x_{n-k+k}\\
    \Rightarrow \quad x_{n-k} &= \left.\left(b_{n-k}-u_{n-k}^{1} x_{n-k+1}-u_{n-k}^{2} x_{n-k+2} - \cdots
        u_{n-k}^{k} x_{n-k+k}\right) \right/ d_{n-k}\\
        &= \left.\left(b_{n-k}-\sum_{j=1}^{k} u_{n-k}^{j} x_{n-k+j}\right) \right/ d_{n-k} \\
\end{align}


\begin{align}
    x_{i} &= \left.\left(b_{i}-\sum_{j=1}^{n-i} u_{i}^{j} x_{i+j}\right) \right/ d_{i} \\
    x_{i} &= \left.\left(b_{i}-\sum_{j=i+1}^{n} u_{i j} x_{j}\right) \right/ u_{i i}
\end{align}





\newpage

\section{Apply on symmetric positive definite tridiagonal matrices}
$$\longleftarrow \text { cholesky } \mathcal{O}\left(\frac{1}{3} n^{3}\right)$$

\begin{align*}
    T &= U^{\T} U \\
    U^{-1} &= \triu\left(x y^{\T}\right) \\
    \left(U^{\T}\right)^{-1} &= \left(U^{-1}\right)^{\T} \\
        &=\left(\triu \left(x y^{\T}\right)\right)^{\T} \\
        &= \tril\left(y x^{\T}\right) \\
    T^{-1} &= \left(U^{\T} U\right)^{-1} \\
        &= \left(U^{-1}\right)\left(U^{\T}\right)^{-1} \\
        &= \triu \left(x y^{\T}\right) \tril \left(y x^{\T}\right) 
\end{align*}


\begin{align*}
    \left( T^{-1} \right)_{i,j} &= \sum_{k=1}^{n} 
            \left[\triu\left(x y^{\T}\right)\right]_{i,k}
            \left[\tril\left(y x^{\T}\right)\right]_{k,j} \\
        &= \sum_{k=1}^{n}
            \left( \begin{cases}
                x_{i} y_{k} ,&  \text{if } i \leqslant j ; \\ 
                0           ,&  \text{if } i > j .
                   \end{cases}\right)
            \left( \begin{cases}
                0           ,&  \text{if } k < j ; \\ 
                y_{k} x_{j} ,&  \text{if } k \geqslant j .
                   \end{cases}\right) \\
        &= \sum_{k=1}^{n}
            \left(x_{i} y_{k} \mathbbm{1}_{\mathbb{Z} \cap \left[i,n\right]}\left( k \right)\right)
            \left(y_{k} x_{j} \mathbbm{1}_{\mathbb{Z} \cap \left[j,n\right]}\left( k \right)\right) \\
        &= x_{i} x_{j} \sum_{k=1}^{n}
            y_{k}^2 \left( \mathbbm{1}_{\mathbb{Z} \cap \left[i,n\right]}\left( k \right)
            \mathbbm{1}_{\mathbb{Z} \cap \left[j,n\right]}\left( k \right)\right) \\
        &= x_{i} x_{j} \sum_{k=1}^{n}
            y_{k}^2 \mathbbm{1}_{\mathbb{Z} \cap \left[\max\left(i,j \right),n\right]}\left( k \right) \\
\end{align*}

\begin{align}
    \left( T^{-1} \right)_{i,j} = 
    \begin{cases}
        x_{i} x_{j} \sum_{k=j}^{n} y_{k}^2 ,&  \text{if } i \leqslant j ; \\ 
        x_{j} x_{i} \sum_{k=i}^{n} y_{k}^2 ,&  \text{if } i \geqslant j .
    \end{cases}
\end{align}


for $i = j$,
\begin{align*}
    \left( T^{-1} \right)_{i,i} = x_{i}^2 \sum_{k=i}^{n} y_{k}^2
        = x_{j}^2 \sum_{k=j}^{n} y_{k}^2 = \left( T^{-1} \right)_{j,j}
\end{align*}

following the definition of \{1,1\}-Semiseparable matrix
\begin{align}
    S &= \begin{cases}
        x_{i} y_{j} &  \text{if } i \leqslant j \ ; \\ 
        x_{j} y_{i} &  \text{if } i \geqslant j .
    \end{cases}\\
    &= \triu\left(x y^{\T}\right) + \tril\left(y x^{\T}, -1\right) \\
    % &= \triu\left(x y^{\T}, 1\right) + \tril\left(y x^{\T}\right) \\
    % &=
    % \begin{bNiceMatrix}[margin]
    %     x_{1} y_{1} & x_{1} y_{2} & \cdots & x_{1} y_{n} \\
    %     x_{1} y_{2} & x_{2} y_{2} & \cdots & x_{2} y_{n} \\
    %     \vdots      & \vdots      & \ddots & \vdots      \\
    %     x_{1} y_{n} & x_{2} y_{n} & \cdots & x_{n} y_{n} 
    % \end{bNiceMatrix}
\end{align}

\begin{align}
    \left( T^{-1} \right)_{i,j} &= 
        \begin{cases}
            x_{i} \left( x_{j} \sum_{k=j}^{n} y_{k}^2 \right) ,&  \text{if } i \leqslant j ; \\ 
            x_{j} \left( x_{i} \sum_{k=i}^{n} y_{k}^2 \right) ,&  \text{if } i \geqslant j .
        \end{cases}\\
        &=  \begin{cases}
            \tilde{x}_{i} \tilde{y}_{j} &  \text{if } i \leqslant j \ ; \\ 
            \tilde{x}_{j} \tilde{y}_{i} &  \text{if } i \geqslant j .
            \end{cases}\\
        &= \triu\left(\tilde{x} \tilde{y}^{\T}\right) + \tril\left(\tilde{y} \tilde{x}^{\T}, -1\right) \\
\end{align}
where $\tilde{x}_{i} = x_{i}$ and $\tilde{y}_{i} = x_{i} \sum_{k=i}^{n} y_{k}^2$.


\begin{align}
    \tilde{x}_{i} &= x_{i} \\
    \Rightarrow \tilde{x} &= x \\
    \tilde{y}_{i} &= x_{i} \sum_{k=i}^{n} y_{k}^2 \\
    \Rightarrow \tilde{y} &= 
        \begin{bNiceMatrix}[margin]
            x_{1} \left( \sum_{k=1}^{n} y_{k}^2 \right)  \\
            x_{2} \left( \sum_{k=2}^{n} y_{k}^2 \right)  \\
            \vdots  \\
            x_{n} \left( \sum_{k=n}^{n} y_{k}^2 \right)  \\ 
        \end{bNiceMatrix}\\
        &= x \circ 
        \begin{bNiceMatrix}[margin]
            y^{\T} y \\
            y_{\left[2:n\right]}^{\T} y_{\left[2:n\right]} \\
            \vdots  \\
            y_{n}^{2} \\
        \end{bNiceMatrix}
\end{align}







$$
\mathbbm{1} \mathds{1} \leqslant
$$



\newpage
\section{28.06.2022 Meeting draft}


\subsection{Tridiagonal matrix (Upper)}




% \noindent Let $U \in \mathbb{R}^{n \times n}$ be a bidiagonal matrix with non-zero diagonal, 
% $i.e. \ u_{ii} \neq 0 \ \text{for} \ i = 1, 2, \ldots , n$,


$n = 2k$

\begin{align*}
    U &= \mqty[
        d_{1} & b^{1}_{1} & b^{2}_{1} &   &   &   &   &   &  \\
          & d_{2} & b^{1}_{2} & b^{2}_{2} &   &   &   &   &  \\
          &   & d_{3} & b^{1}_{3} & b^{2}_{3} &   &   &   &  \\
          &   &   & d_{4} & b^{1}_{4} & b^{2}_{4} &   &   &  \\
          &   &   &   & \ddots & \ddots & \ddots &   &  \\
          &   &   &   && \ddots & \ddots & \ddots &  \\
          &   &   &   &&   & d_{n-3} & b^{1}_{n-3} & b^{2}_{n-3} &  \\
          &   &   &   &&   &   & d_{n-2} & b^{1}_{n-2} & b^{2}_{n-2}\\
          &   &   &   &&   &   &   & d_{n-1} & b^{1}_{n-1}\\
          &   &   &   &&  &   &   &   & d_{n}
    ]\\
    &= \mqty[
        \mqty[d_{1} & b^{1}_{1} \\ & d_{2}] & \mqty[b^{2}_{1} &  \\ b^{1}_{2} & b^{2}_{2}] &   &   &  \\
          & \mqty[d_{3} & b^{1}_{3} \\ & d_{4}] & \mqty[b^{2}_{3} & \\ b^{1}_{4} & b^{2}_{4}] &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & \mqty[d_{2k-3} & b^{1}_{2k-3} \\ & d_{2k-2}] & \mqty[b^{2}_{2k-3} & \\ b^{1}_{2k-2} & b^{2}_{2k-2}] \\
          &   &   &   & \mqty[d_{2k-1} & b^{1}_{2k-1}\\ & d_{2k}]
    ]\\
    &= \mqty[
        D_{1} & B_{1} &   &   &  \\
          & D_{2} & B_{2} &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & D_{k-1} & B_{k-1}\\
          &   &   &   & D_{k}
    ] \in \mathbb{R}^{2k \times 2k}
\end{align*}

\begin{align*}
    X &= \mqty[
        X_{1} \\
        X_{2} \\
        \vdots \\
        X_{k-1} \\
        X_{k}
        ]
    \in \mathbb{R}^{2k \times 2}
    &
    Y &= \mqty[
        Y_{1} \\
        Y_{2} \\
        \vdots \\
        Y_{k-1} \\
        Y_{k}
        ]
    \in \mathbb{R}^{2k \times 2}
    &
    Y^{\T} &= \mqty[
        Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
        ] \in \mathbb{R}^{2 \times 2k}
\end{align*}



\begin{align*}
    XY^{\T} &= \mqty[
        X_{1} \\
        X_{2} \\
        \vdots \\
        X_{k-1} \\
        X_{k}
        ]
        \mqty[
        Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
        ]\\
    &= \mqty[
        X_{1} Y_{1}^{\T} & X_{1} Y_{2}^{\T} & \cdots & X_{1} Y_{k-1}^{\T} & x_{1} Y_{k}^{\T}\\
        X_{2} Y_{1}^{\T} & X_{2} Y_{2}^{\T} & \cdots & X_{2} Y_{k-1}^{\T} & x_{2} Y_{k}^{\T}\\
        \vdots & \vdots & \ddots & \vdots & \vdots\\
        X_{k-1} Y_{1}^{\T} & X_{k-1} Y_{2}^{\T} & \cdots & X_{k-1} Y_{k-1}^{\T} & X_{k-1} Y_{k}^{\T}\\
        X_{k} Y_{1}^{\T} & X_{k} Y_{2}^{\T} & \cdots & X_{k} Y_{k-1}^{\T} & X_{k} Y_{k}^{\T}
        ]\\
    &= X\mqty[
        Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
            ]\\
    &= \mqty[
        XY_{1}^{\T} & XY_{2}^{\T} & \cdots & XY_{k-1}^{\T} & XY_{k}^{\T}
        ]
\end{align*}

\begin{align*}
    \triu(X_{k}) &\coloneqq X_{k} \\
    \triu(Y_{k}^{\T}) &\coloneqq Y_{k}^{\T} \\
    \triu(X_{k} Y_{k}^{\T}) &= X_{k} Y_{k}^{\T}
\end{align*}

\begin{align*}
    \triu(XY^{\T}) &= \mqty[
        \triu(X_{1} Y_{1}^{\T}) & X_{1} Y_{2}^{\T} & \cdots & X_{1} Y_{k-1}^{\T} & X_{1} Y_{k}^{\T}\\
        0_{2 \times 2} & \triu(X_{2} Y_{2}^{\T}) & \cdots & X_{2} Y_{k-1}^{\T} & X_{2} Y_{k}^{\T}\\
        \vdots & \vdots & \ddots & \vdots & \vdots\\
        0_{2 \times 2} & 0_{2 \times 2} & \cdots & \triu(X_{k-1} Y_{k-1}^{\T}) & X_{k-1} Y_{k}^{\T}\\
        0_{2 \times 2} & 0_{2 \times 2} & \cdots & 0_{2 \times 2} & X_{k} Y_{k}^{\T}
        ]\\
    &= \mqty[
        \mqty[
            \triu(X_{1} Y_{1}^{\T}) \\
            0_{2(k-1) \times 2}
            ] &
        \mqty[
            X_{1} Y_{2}^{\T} \\
            \triu(X_{2} Y_{2}^{\T}) \\
            0_{2(k-2) \times 2}
            ] &
        \cdots &
        \mqty[
            X_{1:k-2}Y_{k-1}^{\T} \\
            \triu(X_{k-1}Y_{k-1}^{\T}) \\
            0_{2 \times 2}
            ] &
        X Y_{k}^{\T}
        ]
\end{align*}


\begin{align*}
    U^{-1} &= \triu(XY^{\T}) \\
    I &= U \triu(XY^{\T})
\end{align*}

\begin{align*}
    E_{i} &= \mqty[0 & \cdots & 0 & I_{2 \times 2} & 0 & \cdots & 0]^{\T}
\end{align*}




$k$-th block column, 
\begin{align*}
    E_{k} &= U \triu(XY^{\T})E_{k} \\
    &= U X Y_{k}^{\T}
\end{align*}


\begin{align*}
    X &\coloneqq U^{-1} E_{k} \\
    % e_{n} &= U x \\
    E_{k} &= U X Y_{k}^{\T} \\
        &= U U^{-1} E_{k} Y_{k}^{\T} \\
        &= E_{k} Y_{k}^{\T} \\
    Y_{k}^{\T} &\coloneqq I_{2 \times 2}
\end{align*}


$(k-1)$-th block column, 

\begin{align*}
    E_{k-1} &= U \triu(XY^{\T})E_{k-1} \\
    &= U \mqty[
        X_{1:k-2}Y_{k-1}^{\T} \\
        \triu(X_{k-1}Y_{k-1}^{\T}) \\
        0_{2 \times 2}
        ]
\end{align*}

$(k-1)$-th block row of $(k-1)$-th block column, 

\begin{align*}
    E_{i}^{\T} E_{j} = 
    \begin{cases}
        I_{2 \times 2}, & \text{if} \ i=j \ ;\\
        0_{2 \times 2}, & \text{otherwise}.
    \end{cases} 
\end{align*}

\begin{align*}
    E_{k-1}^{\T} E_{k-1} = I_{2 \times 2} &= E_{k-1}^{\T} U \mqty[
        X_{1:k-2}Y_{k-1}^{\T} \\
        \triu(X_{k-1}Y_{k-1}^{\T}) \\
        0_{2 \times 2}
        ] \\
        &= \mqty[
            0_{2 \times 2(k-2)} & D_{k-1} & B_{k-1}
        ] \mqty[
            X_{1:k-2}Y_{k-1}^{\T} \\
            \triu(X_{k-1}Y_{k-1}^{\T}) \\
            0_{2 \times 2}
            ] \\
        & = D_{k-1} \triu(X_{k-1}Y_{k-1}^{\T}) \\
        % &= \triu(D_{k-1}X_{k-1}Y_{k-1}^{\T}) \ (\text{as}\  D_{k-1} = \triu(D_{k-1}))\\
    Y_{k-1}^{\T} &\coloneqq (D_{k-1} X_{k-1})^{-1}
\end{align*}

\begin{align*}
    D_{k-1} &= \triu(D_{k-1})\\
    D_{k-1}^{-1} &= \triu(D_{k-1}^{-1})\\
    Y_{k-1}^{\T} &\coloneqq (D_{k-1} X_{k-1})^{-1}\\
    D_{k-1} \triu(X_{k-1}Y_{k-1}^{\T}) &= D_{k-1} \triu(X_{k-1}(D_{k-1} X_{k-1})^{-1})\\
        &= D_{k-1} \triu(X_{k-1} X_{k-1}^{-1} D_{k-1}^{-1})\\
        &= D_{k-1} \triu(D_{k-1}^{-1})\\
        &= D_{k-1} D_{k-1}^{-1}\\
        &= I_{2 \times 2}
\end{align*}


\begin{align*}
    X &\coloneqq U^{-1} E_k\\
    E_{k} &= U X \\
    E_{k}^{\T} E_{k} = I_{2 \times 2} &= E_{k}^{\T} U X \\
        &= \mqty[
            0_{2 \times 2(k-1)} & D_{k}
        ] X \\
        &= D_{k} X_{k} \\
    Y_{k}^{\T} &\coloneqq I_{2 \times 2} \\
        &\coloneqq (D_{k} X_{k})^{-1}
    % y_{n-1} :&= (d_{n-1} x_{n-1})^{-1}
\end{align*}

\begin{align*}
    X &\coloneqq U^{-1} E_{k} \\
    Y_{i}^{\T} &\coloneqq (D_{i} X_{i})^{-1}
\end{align*}









\newpage
$n = 2k + 1$
\begin{align*}
    U &= \mqty[
        \mqty[d_{1}] & \mqty[b^{1}_{1} & b^{2}_{1}] &   &   &  \\
          & \mqty[d_{2} & b^{1}_{2} \\ & d_{3}] & \mqty[b^{2}_{2} & \\ b^{1}_{3} & b^{2}_{3}] &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & \mqty[d_{2k-2} & b^{1}_{2k-2} \\ & d_{2k-1}] & \mqty[b^{2}_{2k-2} & \\ b^{1}_{2k-1} & b^{2}_{2k-1}] \\
          &   &   &   & \mqty[d_{2k} & b^{1}_{2k}\\ & d_{2k+1}]
    ]\\
    &= \mqty[
        \tilde{D_{1}} & \tilde{B_{1}} &   &   &  \\
          & D_{2} & B_{2} &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & D_{k} & B_{k}\\
          &   &   &   & D_{k+1}
    ] \in \mathbb{R}^{(2k+1) \times (2k+1)}
\end{align*}


\begin{align*}
    X &\coloneqq U^{-1} E_{k+1} \\
    Y_{i}^{\T} &\coloneqq (D_{i} X_{i})^{-1} \ \text{for}\ i = 2,\ \cdots,\ k+1 \\
    Y_{1}^{\T} &\coloneqq (D_{1} X_{1})^{+} = (D_{1} X_{1})^{\T} (D_{1} X_{1} (D_{1} X_{1})^{\T})^{-1}
\end{align*}

% \begin{equation}
%     \left[\begin{array}{ll|ll|l}
%     a & b & c & & \\
%     & d & e & f & \\
%     \hline & & g & h & i \\
%     & & j & R \\
%     \hline & & l
%     \end{array}\right]
% \end{equation}






\newpage
\subsection{Banded matrix (Upper)}

$n = ku + r, \ 0\leq r<u$

\begin{align*}
    U &= \mqty[
        d_{1} & b^{1}_{1} & b^{2}_{1} & \cdots & b^{u}_{1} &   &   &   \\
          & d_{2} & b^{1}_{2} & b^{2}_{2} & \cdots & b^{u}_{2} &   &   \\
          &   & \ddots & \ddots & \ddots & \cdots & \ddots &   \\
          &   &   & \ddots & \ddots & \ddots & \cdots & b^{u}_{n-u} \\
          &   &   &   & \ddots & \ddots & \ddots & \vdots \\
          &   &   &   &   & \ddots & \ddots & b^{2}_{n-2} \\
          &   &   &   &   &   & \ddots & b^{1}_{n-1} \\
          &   &   &   &   &   &   & d_{n} \\
    ]\\
    % &= \mqty[
    %     D_{1} & B_{1} &   &   &  \\
    %       & D_{2} & B_{2} &   &  \\
    %       &   & \ddots & \ddots &  \\
    %       &   &   & D_{k} & B_{k}\\
    %       &   &   &   & D_{k+1}
    % ] \in \mathbb{R}^{n \times n} = \mathbb{R}^{(ku + r) \times (ku + r)}
\end{align*}


$r = 0,\ n = ku, $
\begin{align*}
    U &= \mqty[
        D_{1} & B_{1} &   &   &  \\
          & D_{2} & B_{2} &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & D_{k-1} & B_{k-1}\\
          &   &   &   & D_{k}
    ] \in \mathbb{R}^{ku \times ku},\\
    D_{i} &\in \mathbb{R}^{u \times u}, \ B_{i} \in \mathbb{R}^{u \times u} \ \text{for} \ i = 1,\ 2,\ \cdots,\ k.
\end{align*}

\begin{align*}
    X &= \mqty[
        X_{1} \\
        X_{2} \\
        \vdots \\
        X_{k}
        ]
    \in \mathbb{R}^{ku \times u}
    &
    Y &= \mqty[
        Y_{1} \\
        Y_{2} \\
        \vdots \\
        Y_{k}
        ]
    \in \mathbb{R}^{ku \times u}
    &
    Y^{\T} &= \mqty[
        Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k}^{\T}
        ] \in \mathbb{R}^{u \times ku}
\end{align*}


\begin{align*}
    X_{i},\ Y_{i}^{\T} &\in \mathbb{R}^{u \times u},\ \text{for} \ i = 1,\ 2,\ \cdots,\ k \\
    X &\coloneqq U^{-1} E_{k} \\
    Y_{i}^{\T} &\coloneqq (D_{i} X_{i})^{-1}
\end{align*}



$r \neq 0,\ n = ku+r, $
\begin{align*}
    U &= \mqty[
        \tilde{D}_{1} & \tilde{B}_{1} &   &   &  \\
          & D_{2} & B_{2} &   &  \\
          &   & \ddots & \ddots &  \\
          &   &   & D_{k} & B_{k}\\
          &   &   &   & D_{k+1}
    ] \in \mathbb{R}^{(ku + r) \times (ku + r)},\\
    \tilde{D}_{1} &\in \mathbb{R}^{r \times r}, \ \tilde{B}_{1} \in \mathbb{R}^{r \times u};\\
    D_{i} &\in \mathbb{R}^{u \times u}, \ B_{i} \in \mathbb{R}^{u \times u} \ \text{for} \ i =  2,\ \cdots,\ k+1.
\end{align*}


\begin{align*}
    X &= \mqty[
        \tilde{X}_{1} \\
        X_{2} \\
        \vdots \\
        X_{k+1}
        ]
    \in \mathbb{R}^{(ku + r) \times u}
    &
    Y &= \mqty[
        \tilde{Y}_{1} \\
        Y_{2} \\
        \vdots \\
        Y_{k+1}
        ]
    \in \mathbb{R}^{(ku + r) \times u}
    &
    Y^{\T} &= \mqty[
        \tilde{Y}_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k+1}^{\T}
        ] \in \mathbb{R}^{u \times (ku + r)}
\end{align*}


\begin{align*}
    \tilde{X}_{1} &\in \mathbb{R}^{r \times u} \\
    \tilde{Y}_{1}^{\T} &\in \mathbb{R}^{u \times r} \\
    X_{i},\ Y_{i}^{\T} &\in \mathbb{R}^{u \times u} \ \text{for} \ i = 2,\ \cdots,\ k+1 \\
    X &\coloneqq U^{-1} E_{k+1} \\
    \tilde{Y}_{1}^{\T} &\coloneqq (D_{1} X_{1})^{+} = (D_{1} X_{1})^{\T} (D_{1} X_{1} (D_{1} X_{1})^{\T})^{-1} \\
    \triu(D_{1} X_{1} \tilde{Y}_{1}^{\T}) &= I_{r \times r}\\
    Y_{i}^{\T} &\coloneqq (D_{i} X_{i})^{-1} \ \text{for}\ i = 2,\ \cdots,\ k+1 
\end{align*}



\newpage

\section{28.06.2022 Meeting formal}

\subsection{Notation}

\noindent This notes use Householder notation and start indexing at one.

\begin{align*}
    \text{Scalars, lower case Greek letters: }& \alpha,\, \beta,\, \gamma,\, \chi,\, etc.\\
    \text{Vectors, lower case Roman letter: }& a,\, b,\, c,\, x,\, etc.\\
    \text{Matrix, upper case Roman letter: }& A,\, B,\, C,\, X,\, etc.\\
\end{align*}

\subsection{Repersentation}

\subsubsection*{Matrix \& Vector}
\begin{align*}
    x   =&
        \begin{bNiceMatrix}[vlines,margin]
            \chi_{1} \\
            \chi_{2} \\
            \Vdots   \\
            \chi_{n} 
        \end{bNiceMatrix} \in \mathbb{R}^{n}\\
    A   =&
        \begin{bNiceMatrix}[vlines,margin]
            \alpha_{11} & \alpha_{12} & \cdots & \alpha_{1n} \\
            \alpha_{21} & \alpha_{22} & \cdots & \alpha_{2n} \\
            \Vdots      & \Vdots      & \Vdots & \Vdots      \\
            \alpha_{m1} & \alpha_{m2} & \cdots & \alpha_{1n} \\
        \end{bNiceMatrix}\\
        =&
        \begin{bNiceMatrix}[vlines,margin]
            a_{1} & a_{2} & \cdots & a_{n} 
        \end{bNiceMatrix}\in \mathbb{R}^{m \times n}\\
\end{align*}

\subsubsection*{Block Matrix \& Block Vector}
\begin{align*}
    x   =&
        \begin{bNiceMatrix}[vlines,margin]
            x_{1} \\
            x_{2} \\
            \Vdots   \\
            x_{n} 
        \end{bNiceMatrix} \in \mathbb{R}^{kn},\, x_{i} \in \mathbb{R}^{k}\\
    A   =&
        \begin{bNiceMatrix}[vlines,margin]
            A_{11} & A_{12} & \cdots & A_{1n} \\
            A_{21} & A_{22} & \cdots & A_{2n} \\
            \Vdots & \Vdots & \Vdots & \Vdots      \\
            A_{m1} & A_{m2} & \cdots & A_{1n} \\
        \end{bNiceMatrix}\\
        =&
        \begin{bNiceMatrix}[vlines,margin]
            A_{1} & A_{2} & \cdots & A_{n} 
        \end{bNiceMatrix}\in \mathbb{R}^{lm \times kn},\, A_{ij} \in \mathbb{R}^{l \times k}
\end{align*}





\newpage
\subsection{Content}


Consider an upper banded matrix $U \in \mathbb{R}^{n \times n}$,

\begin{align}
    U = 
    \begin{bNiceMatrix}[margin]
        \alpha_{1} & \beta^{1}_{1} & \beta^{2}_{1} & \Cdots & \beta^{u}_{1} &   &   &   \\
          & \alpha_{2} & \beta^{1}_{2} & \beta^{2}_{2} & \Cdots & \beta^{u}_{2} &   &   \\
          &   & \Ddots & \Ddots &  &   & \Ddots &   \\
          &   &   &   &   &   &   & \beta^{u}_{n-u} \\
          &   &   &   &   &   &   & \Vdots \\
          &   &   &   &   &   &   & \beta^{2}_{n-2} \\
          &   &   &   &   &   &   & \beta^{1}_{n-1} \\
          &   &   &   &   &   &   & \alpha_{n} \\
    \end{bNiceMatrix}\label{U_banded}.
\end{align}
% \nonumber

\noindent Then try to show that its inverse can be repersent as the upper triangular part of an outer product,
\textit{i.e.}\ ,
\begin{align}
    U^{-1} = \triu(XY^{\T}) \label{main_eqn}
\end{align}

\noindent Let $X,\ Y \in \mathbb{R}^{n \times u}$, consider the following cases of $n$,

\subsection*{Case 1, \bm{$n = ku$}}

then \eqref{U_banded} can be repersent as a block upper bidiagonal matrix,










\NiceMatrixOptions{code-for-first-row = \scriptstyle,code-for-first-col = \scriptstyle}
\setcounter{MaxMatrixCols}{30}



\begin{align*}
    \begin{bNiceMatrix}[first-row,first-col]
          & \hspace*{1mm} & \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$r$\end{turn}} & \hspace*{1mm} & 
            \hspace*{1mm} && \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} && \hspace*{1mm} & 
            \hspace*{1mm} && \Cdots && \hspace*{1mm} & 
            \hspace*{1mm} && \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} && \hspace*{1mm} \\
        \hspace*{1mm} &
            d_{1} & \Cdots & b^{r-1}_{1} & b^{r}_{1} & \Cdots & b^{u}_{1} &&&&&&&&&&&& \\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$r$\end{sideways}} &
            & \Ddots & \Vdots & \Vdots &&& \Ddots &&&&&&&&&&& \\
        \hspace*{1mm} &
            && d_{r} & b^{1}_{r} & \Cdots & \Cdots & \Cdots & b^{u}_{r} &&&&&&&&&&\\
        % 
        \hspace*{1mm} &
            &&& d_{1+r} & \Cdots & \Cdots & \Cdots & b^{u-1}_{1+r} & b^{u}_{r+1} &&&&&&&&&\\
          &
            &&&& \Ddots &&& \Vdots & \Vdots & \Ddots &&&&&&&&\\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &
            &&&&& \Ddots && \Vdots & \Vdots && \Ddots &&&&&&&\\
          &
            &&&&&& \Ddots[draw-first] & \Vdots[draw-first] & \Vdots[draw-first] &&& \Ddots[draw-first] &&&&&&\\
        \hspace*{1mm}  &&&&&&&& d_{u+r} & b^{1}_{u+r} & \Cdots & \Cdots & \Cdots & b^{u}_{u+r} &&&&&\\
        % 
        \hspace*{1mm} &
            &&&&&&&&&&&&&&&&&\\
          &
            &&&&&&&&&&&&&&&&&\\
        \Vdots &
            &&&&&&&&&& \ddots && \vdots & \vdots && \ddots &&\\
          &
            &&&&&&&&&&&&&&&&&\\
        \hspace*{1mm} &
            &&&&&&&&&&&&&&&&&\\
        % 
        \hspace*{1mm} &
            &&&&&&&&&&&&& d_{n-u+1} & \Cdots & \Cdots & \Cdots & b^{u}_{n-u+1}\\
         &
            &&&&&&&&&&&&&& \Ddots &&& \Vdots \\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &
            &&&&&&&&&&&&&&& \Ddots && \Vdots \\
         &
            &&&&&&&&&&&&&&&& \Ddots[draw-first] & \Vdots \\
        \hspace*{1mm} &
            &&&&&&&&&&&&&&&&& d_{n}\\
    \end{bNiceMatrix}
\end{align*}







\begin{align}
    U &=
    \begin{bNiceMatrix}[first-row,first-col,margin]
          & \hspace*{1mm} & \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} & \hspace*{1mm} &
            \hspace*{1mm} & \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} & \hspace*{1mm} &
            \hspace*{1mm} & \Cdots & \hspace*{1mm} &
            \hspace*{1mm} & \Cdots[line-style={solid,<->}]^{\begin{turn}{0}$u$\end{turn}} & \hspace*{1mm} \\
        % 
        \hspace*{1mm} &
            \alpha_{1} & \Cdots & \beta^{u-1}_{1} & \beta^{u}_{1} &&&&&&&&\\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &
            & \Ddots & \Vdots & \Vdots & \Ddots[draw-first] &&&&&&&\\
        \hspace*{1mm} &
            && \alpha_{u} & \beta^{1}_{u} & \Cdots & \beta^{u}_{u} &&&&&&\\
        % 
        \hspace*{1mm} &
            &&& \alpha_{u+1} & \Cdots & \beta^{u-1}_{u+1} & \beta^{u}_{u+1} &&&&&\\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &
            &&&& \Ddots[draw-first] & \Vdots[draw-first] & \Vdots[draw-first] & \Ddots[draw-first] &&&&\\
        \hspace*{1mm} &
            &&&&& \alpha_{2u} & \beta^{1}_{2u} & \Cdots & \beta^{u}_{2u} &&&\\
        % 
        \hspace*{1mm} &
            &&&&&&&&&&&\\
        \Vdots &
            &&&&&&  & \ddots &&& \ddots &\\
        \hspace*{1mm} &
            &&&&&&&&&&&\\
        % 
        \hspace*{1mm} &
            &&&&&&&&& \alpha_{(k-1)u+1} & \Cdots & \beta^{u-1}_{(k-1)u+1} \\
        \Vdots[line-style={solid,<->}]_{\begin{sideways}$u$\end{sideways}} &
            &&&&&&&&&& \Ddots[draw-first] & \Vdots[draw-first] \\
        \hspace*{1mm} &
            &&&&&&&&&&& \alpha_{ku}\\
    \end{bNiceMatrix}
    \nonumber \\
    &= 
    \begin{bNiceMatrix}[margin]
        D_{1}   & B_{1} &           &           &  \\
                & D_{2} & B_{2}     &           &  \\
                &       & \ddots    & \ddots    &  \\
                &       &           & D_{k-1}   & B_{k-1}\\
                &       &           &           & D_{k}
    \end{bNiceMatrix}\in \mathbb{R}^{ku \times ku},\, D_{i},\,B_{i} \in \mathbb{R}^{u \times u} \ \text{for} \ i =  1,\, 2,\, \dots,\, k.
    \label{U_block_bi}
\end{align}

\noindent Repersent the $n$-dimensional identity matrix $I_{n \times n}$ in block form,

\begin{align*}
    I_{n \times n} = I_{ku \times ku} = \diag(\underbrace{I_{u \times u},\ I_{u \times u},\ \cdots,\ I_{u \times u}}_{k}) =
    \begin{bNiceMatrix}[vlines,margin]
        E_{1} & E_{2} & \cdots & E_{k}
    \end{bNiceMatrix}.
\end{align*}


\noindent then, its block columns $E_{i}$ for $i =  1,\, 2,\, \dots,\, k$ satisfies

\begin{align*}
    E_{i} &\in \mathbb{R}^{ku \times u} \\
    E_{i}^{\T} E_{j} &= 
    \begin{cases}
        I_{u \times u}, & \text{if} \ i=j \ ;\\
        0_{u \times u}, & \text{otherwise}.
    \end{cases}.
\end{align*}


\noindent To find $X$ and $Y$ such that \eqref{main_eqn} holds, let

\begin{align*}
    X =
    \begin{bNiceMatrix}[margin]
        X_{1} \\
        X_{2} \\
        \vdots \\
        X_{k-1} \\
        X_{k}
    \end{bNiceMatrix} \in \mathbb{R}^{ku \times u},\,
    Y = 
    \begin{bNiceMatrix}[margin]
        Y_{1} \\
        Y_{2} \\
        \vdots \\
        Y_{k-1} \\
        Y_{k}
    \end{bNiceMatrix} \in \mathbb{R}^{ku \times u},\, X_{i},\,Y_{i} \in \mathbb{R}^{u \times u}\ \text{for} \ i =  1,\, 2,\, \dots,\, k,
\end{align*}

\noindent and let $X_{k}$ and $Y_{k}^{\T}$ be upper triangular matrix, 
then $\triu(X_{k} Y_{k}^{\T}) = X_{k} Y_{k}^{\T}$.


\noindent For the outer product form, 

\begin{align*}
    Y^{\T} &=
        \begin{bNiceMatrix}[vlines,margin]
            Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
        \end{bNiceMatrix} \in \mathbb{R}^{u \times ku} \\
    XY^{\T} &=
        \begin{bNiceMatrix}[margin]
            X_{1} \\
            X_{2} \\
            \vdots \\
            X_{k-1} \\
            X_{k}
        \end{bNiceMatrix}
        \begin{bNiceMatrix}[vlines,margin]
            Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
        \end{bNiceMatrix} \\
        &= \begin{bNiceMatrix}[vlines,margin]
            X_{1} Y_{1}^{\T} & X_{1} Y_{2}^{\T} & \cdots & X_{1} Y_{k-1}^{\T} & x_{1} Y_{k}^{\T}\\
            X_{2} Y_{1}^{\T} & X_{2} Y_{2}^{\T} & \cdots & X_{2} Y_{k-1}^{\T} & x_{2} Y_{k}^{\T}\\
            \vdots & \vdots & \vdots & \vdots & \vdots\\
            X_{k-1} Y_{1}^{\T} & X_{k-1} Y_{2}^{\T} & \cdots & X_{k-1} Y_{k-1}^{\T} & X_{k-1} Y_{k}^{\T}\\
            X_{k} Y_{1}^{\T} & X_{k} Y_{2}^{\T} & \cdots & X_{k} Y_{k-1}^{\T} & X_{k} Y_{k}^{\T}
        \end{bNiceMatrix} \\
        &= X
        \begin{bNiceMatrix}[vlines,margin]
            Y_{1}^{\T} & Y_{2}^{\T} & \cdots & Y_{k-1}^{\T} & Y_{k}^{\T}
        \end{bNiceMatrix} \\
        &= 
        \begin{bNiceMatrix}[vlines,margin]
            XY_{1}^{\T} & XY_{2}^{\T} & \cdots & XY_{k-1}^{\T} & XY_{k}^{\T}
        \end{bNiceMatrix} \in \mathbb{R}^{ku \times ku},
\end{align*}

\noindent and its the upper triangular componnent,

\begin{align}
    \triu(XY^{\T}) &= 
        \begin{bNiceMatrix}[vlines,margin]
            \triu(X_{1} Y_{1}^{\T}) & X_{1} Y_{2}^{\T} & \cdots & X_{1} Y_{k-1}^{\T} & X_{1} Y_{k}^{\T}\\
            0_{u \times u} & \triu(X_{2} Y_{2}^{\T}) & \cdots & X_{2} Y_{k-1}^{\T} & X_{2} Y_{k}^{\T}\\
            \vdots & \vdots & \vdots & \vdots & \vdots\\
            0_{u \times u} & 0_{u \times u} & \cdots & \triu(X_{k-1} Y_{k-1}^{\T}) & X_{k-1} Y_{k}^{\T}\\
            0_{u \times u} & 0_{u \times u} & \cdots & 0_{u \times u} & X_{k} Y_{k}^{\T}
        \end{bNiceMatrix}
        \nonumber \\
        &= 
        \begin{bNiceMatrix}[vlines,margin]
            \triu(X_{1} Y_{1}^{\T}) & X_{1} Y_{2}^{\T}          &        & X_{1:k-2}Y_{k-1}^{\T}      &  \\
            0_{(k-2)u \times u}     & \triu(X_{2} Y_{2}^{\T})   & \cdots & \triu(X_{k-1}Y_{k-1}^{\T}) & X Y_{k}^{\T}\\
            0_{u \times u}          & 0_{(k-2)u \times u}       &        & 0_{u \times u}             &  
        \end{bNiceMatrix}. \label{triuXYt}
zz\end{align}


\noindent From \eqref{main_eqn},

\begin{align}
    I_{n \times n} = U \triu(XY^{\T}). \label{focus_eqn}
\end{align}


\noindent For $X$ and $Y_{k}$, from \eqref{triuXYt}, the $k$-th block column of \eqref{focus_eqn} can be written as,

\begin{align}
    E_{k} &= U \triu(XY^{\T})E_{k} \nonumber \\
    E_{k} &= U X Y_{k}^{\T} \label{eqnX_ku}
\end{align}


\noindent Define that

\begin{align}
    X &\coloneqq U^{-1} E_{k}; \label{X_ku} \\ 
    Y_{k}^{\T} &\coloneqq I_{u \times u}, \label{Yk_ku}
\end{align}

\noindent which can be shown that \eqref{eqnX_ku} holds for the defined \eqref{X_ku} and \eqref{Yk_ku} through

\begin{align*}
    U X Y_{k}^{\T} &= U U^{-1} E_{k} I_{u \times u} \\
        &= I_{n \times n} E_{k} I_{u \times u} \\
        &= E_{k} I_{u \times u} \\
        &= E_{k},\ \text{as required}.
\end{align*}


\noindent Then, for $Y_{k-1}$, forming the $(k-1)$-th block column of \eqref{focus_eqn} from \eqref{triuXYt} first,

\begin{align*}
    E_{k-1} &= U \triu(XY^{\T})E_{k-1} \\
    &= U 
    \begin{bNiceMatrix}[margin]
        X_{1:k-2}Y_{k-1}^{\T} \\
        \triu(X_{k-1}Y_{k-1}^{\T}) \\
        0_{u \times u}
    \end{bNiceMatrix}.
\end{align*}

\noindent Focusing on the $(k-1)$-th block row of $(k-1)$-th block column, 


% \begin{bNiceMatrix}[margin]
%     X_{1:k-2}Y_{k-1}^{\T} \\
%     \triu(X_{k-1}Y_{k-1}^{\T}) \\
%     0_{u \times u}
% \end{bNiceMatrix}

\begin{align}
    E_{k-1}^{\T} E_{k-1} &= E_{k-1}^{\T} U 
        \begin{bNiceMatrix}[margin]
            X_{1:k-2}Y_{k-1}^{\T} \\
            \triu(X_{k-1}Y_{k-1}^{\T}) \\
            0_{u \times u}
        \end{bNiceMatrix} \nonumber \\
    I_{u \times u} &=
        \begin{bNiceMatrix}[vlines,margin]
            0_{u \times (k-2)u} & D_{k-1} & B_{k-1}
        \end{bNiceMatrix} 
        \begin{bNiceMatrix}[hlines,margin]
            X_{1:k-2}Y_{k-1}^{\T} \\
            \triu(X_{k-1}Y_{k-1}^{\T}) \\
            0_{u \times u}
        \end{bNiceMatrix} \nonumber \\
    I_{u \times u} &= D_{k-1} \triu(X_{k-1}Y_{k-1}^{\T}). \label{eqnY_k_1u}
\end{align}



\noindent Define that

\begin{align}
    Y_{k-1}^{\T} &\coloneqq (D_{k-1} X_{k-1})^{-1}, \label{eqn_Y_k_1_ku}
\end{align}

\noindent and notice that $D_{k-1} \in \mathbb{R}^{u \times u}$ is a upper triangular, therefore 

\begin{align}
    D_{k-1} &= \triu(D_{k-1}); \nonumber \\
    D_{k-1}^{-1} &= \triu(D_{k-1}^{-1}). \label{D_k_1}
\end{align}

\noindent With the fact \eqref{D_k_1}, \eqref{eqnY_k_1u} holds for the defined \eqref{eqn_Y_k_1_ku} as, 

\begin{align*}
    D_{k-1} \triu(X_{k-1}Y_{k-1}^{\T}) &= D_{k-1} \triu(X_{k-1}(D_{k-1} X_{k-1})^{-1})\\
        &= D_{k-1} \triu(X_{k-1} X_{k-1}^{-1} D_{k-1}^{-1})\\
        &= D_{k-1} \triu(D_{k-1}^{-1})\\
        &= D_{k-1} D_{k-1}^{-1}\\
        &= I_{u \times u},\ \text{as required}.
\end{align*}

\noindent Similar ideas can be use to redefine $Y_{k}^{\T}$ in \eqref{Yk_ku}, from \eqref{X_ku},




\begin{align*}
    E_{k} &= U X \\
    E_{k}^{\T} E_{k} &= E_{k}^{\T} U X \\
    I_{u \times u} &= E_{k}^{\T} U X \\
        &= 
        \begin{bNiceMatrix}[vlines,margin]
            0_{u \times (k-1)u} & D_{k}
        \end{bNiceMatrix}
        \begin{bNiceMatrix}[hlines,margin]
            X_{1:k-1} \\
            X_{k}
        \end{bNiceMatrix}\\
        &= D_{k} X_{k} \\
    I_{u \times u} &= (D_{k} X_{k})^{-1},
\end{align*}

\noindent following that

\begin{align*}
    Y_{k}^{\T} &\coloneqq I_{u \times u} \\
        &\coloneqq (D_{k} X_{k})^{-1}.
\end{align*}

\noindent In summary, for $U \in \mathbb{R}^{ku \times ku}$, \eqref{main_eqn} holds the following definitions of $X$ and $Y$:

\begin{align*}
    X &\coloneqq U^{-1} E_{k} \\
    Y_{i}^{\T} &\coloneqq (D_{i} X_{i})^{-1}
\end{align*}









% hlines,




\end{document}




